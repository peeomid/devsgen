(function(){"use strict";class v{static format(e,n="  "){let t="",i=0,o=!1,r=!1,s=!1;const g=new Set(["{","[","("]),m=new Set(["}","]",")"]),l=[],h=()=>{t+=`
`+n.repeat(i)};for(let p=0;p<e.length;p++){const f=e[p];if(s){t+=f,s=!1;continue}if(f==="\\"){t+=f,(o||r)&&(s=!0);continue}if(!r&&f==="'"&&!o){o=!0,t+=f;continue}else if(o&&f==="'"){o=!1,t+=f;continue}if(!o&&f==='"'&&!r){r=!0,t+=f;continue}else if(r&&f==='"'){r=!1,t+=f;continue}if(o||r){t+=f;continue}if(g.has(f)){if(f==="{"){const u=t.substring(Math.max(0,t.length-30));u.includes("function ")&&u.endsWith(")")&&(t+=" ")}const w=t,C=l.length>0?l[l.length-1]:void 0;t+=f,i++;let E=p+1;for(;E<e.length&&/\s/.test(e[E]);)E++;const b=E<e.length&&m.has(e[E]);let c={type:f,multiline:!1};if(!b)if(f==="("){const u=w.trimEnd();if(!/\b(int|string|float|bool|array|object|resource|NULL)\s*$/.test(u)){const d=this.analyzeBracketContent(e,p,"(");if(d){const x=this.isFunctionLikeCall(w);c.multiline=this.shouldIndentParentheses(d,C,x)}}}else if(f==="["){const u=this.analyzeBracketContent(e,p,"[");u&&(c.multiline=this.shouldIndentArray(u,C))}else f==="{"&&(c.multiline=!0);l.push(c),c.multiline&&h();continue}if(m.has(f)){const w=l.pop();i=Math.max(0,i-1);let C=!1;if(f===")"){const c=t.substring(Math.max(0,t.length-50));/\b(int|string|float|bool|array|object|resource|NULL)\s*\([^)]*$/.test(c)&&(C=!0)}let E="";for(let c=t.length-1;c>=0;c--)if(!/\s/.test(t[c])){E=t[c];break}this.shouldIndentClosingBracket(t,f,E,C,w)&&(t+=`
`+n.repeat(i)),t+=f;continue}if(f===","){t+=f;let w=p+1;for(;w<e.length&&/\s/.test(e[w]);)w++;if(w<e.length&&(e[w]==="}"||e[w]==="]"||e[w]===")"))continue;const E=l.length>0?l[l.length-1]:void 0;this.shouldBreakAfterComma(E)?h():t+=" ";continue}if(f===";"){t+=f;let w=p+1;for(;w<e.length&&/\s/.test(e[w]);)w++;w<e.length&&i===0&&(t+=`

`);continue}if((f==="+"||f==="-"||f==="*"||f==="/"||f==="=")&&!o&&!r&&(f==="="||i>0)&&!(f==="="&&p+1<e.length&&e[p+1]===">")){if(t.length>0&&!t.endsWith(" ")&&!t.endsWith(`
`)){const w=t[t.length-1];/[a-zA-Z0-9_$)]/.test(w)&&(t+=" ")}t+=f,p+1<e.length&&!/\s/.test(e[p+1])&&(t+=" ");continue}if(f===":"||f==="="&&p+1<e.length&&e[p+1]===">"){if(f==="="&&e[p+1]===">"){const w=t[t.length-1];w&&w!==" "&&w!==`
`&&(t+=" ");let C="";for(let d=t.length-1;d>=0;d--){const x=t[d];if(!/\s/.test(x)){C=x;break}}let E=p+2;for(;E<e.length&&/\s/.test(e[E]);)E++;const b=e.substring(E,E+5).toLowerCase();let c=!1;if(b.startsWith("array")){let d=E;for(;d<e.length&&e[d]!==")";)d++;if(d<e.length){let x=d+1;for(;x<e.length&&/\s/.test(e[x]);)x++;x<e.length&&e[x]==="{"&&(c=!0)}}const u=l.length>0?l[l.length-1]:void 0,$=C==="]"||u?.type==="{"&&c;if(t+="=>",p++,$){t+=`
`+n.repeat(Math.max(0,i+1));let d=p+1;for(;d<e.length&&(e[d]===`
`||e[d]===" "||e[d]==="	");)d++;p=d-1}else t+=" "}else t+=": ";continue}if(f===`
`){let w=p+1,C=1;for(;w<e.length&&e[w]===`
`;)C++,w++;C>=2?(t.endsWith(`
`)?t.endsWith(`

`)||(t+=`
`):t+=`

`,p=w-1):t.endsWith(`
`)||(t+=`
`,i>0&&(t+=n.repeat(i)));continue}if(!/\s/.test(f))t+=f;else if(f===" "){if(t.endsWith(`
`)){i===0&&(t+=f);continue}if(!t.endsWith(" ")){const w=t[t.length-1],C=p+1<e.length?e[p+1]:"";if(g.has(w)||m.has(C))continue;t+=f}}}return t}static shouldBreakAfterComma(e){return e?e.type==="{"?!0:e.multiline:!1}static shouldIndentParentheses(e,n,t=!1){return e.hasAssignment||e.hasNewline||!t&&e.hasNested&&e.firstToken!=="function"||e.hasNested&&e.contentLength>80&&e.firstToken!=="function"?!0:!t&&e.firstToken==="function"?!1:!!(!t&&n?.multiline&&e.commaCount>0&&(e.hasNested||e.contentLength>12)||e.commaCount>=2&&e.contentLength>60||e.contentLength>120)}static shouldIndentArray(e,n){return!!(e.hasNested||e.hasAssignment||e.hasNewline||e.contentLength>100||e.commaCount>=6||n?.multiline&&(e.hasNested||e.contentLength>60||e.commaCount>=4))}static analyzeBracketContent(e,n,t){const i=t==="("?")":t==="["?"]":"}",o=new Set(["(","[","{"]),r=new Set([")","]","}"]),s=[];let g=!1,m="",l=!1,h=!1,p=!1,f=0,w=0,C=!1,E="",b=!1;for(let c=n+1;c<e.length;c++){const u=e[c];if(l){l=!1,f++;continue}if(u==="\\"){l=!0,f++;continue}if(g){u===m&&(g=!1),f++;continue}if(u==='"'||u==="'"){g=!0,m=u,f++,b||(b=!0,E=u);continue}if(u===`
`){C=!0;continue}if(u===","){w++;continue}if(!/\s/.test(u)&&(f++,!b)){b=!0;let $=c;for(;$<e.length&&/[a-zA-Z0-9_]/.test(e[$]);)$++;E=e.substring(c,$).toLowerCase()}if(u==="="){c+1<e.length&&e[c+1],p=!0;continue}if(o.has(u)){s.push(u),s.length===1&&(h=!0);continue}if(r.has(u)){if(s.length===0)return u===i?{hasNested:h,hasAssignment:p,contentLength:f,commaCount:w,hasNewline:C,firstToken:E}:{hasNested:h,hasAssignment:p,contentLength:f,commaCount:w,hasNewline:C,firstToken:E};const $=s[s.length-1],d=$==="("?")":$==="["?"]":"}";s.pop();continue}}return null}static isFunctionLikeCall(e){const n=e.trimEnd();if(!n)return!1;const t=n[n.length-1];return/[a-zA-Z0-9_.\)]/.test(t)}static addMissingSemicolons(e){const n=e.split(`
`),t=[];for(let i=0;i<n.length;i++){let o=n[i];const r=o.trim();if(!r||r.endsWith(";")||r.endsWith("{")||r.endsWith("}")){t.push(o);continue}/^[\s]*(const|let|var|return)\s/.test(r)&&!r.endsWith("{")&&(o=o.trimRight()+";"),t.push(o)}return t.join(`
`)}static shouldIndentClosingBracket(e,n,t,i,o){if(i||t==="{"||t==="["||t==="(")return!1;if(o?.multiline)return!0;if(n===")"){const r=e.substring(Math.max(0,e.length-50)),s=r.lastIndexOf(`
`);if(s===-1)return!1;const g=r.substring(s+1);if(g.trim().length<50&&!g.includes(`
`))return!1}if(n==="]"){const r=e.substring(Math.max(0,e.length-30)),s=r.lastIndexOf(`
`);if(s===-1||r.substring(s+1).trim().length<30)return!1}return!0}}function N(a){const e=a.trim();if(!e)return"unknown";try{return JSON.parse(e),"json"}catch{}return/\b(select|with)\b[\s\S]*\bfrom\b/i.test(e)||/\b(insert\s+into|update\s+\w+\s+set|delete\s+from|create\s+table|alter\s+table|drop\s+table)\b/i.test(e)?"sql":/^\s*[\w-]+\s*:\s*\{[^};]+\}\s*$/m.test(e)?"yaml":/{[^}]*;[^}]*}/m.test(e)?"css":/^\s*<\?xml\b/.test(e)||/<\w+[^>]*\/>/.test(e)?"xml":/<!DOCTYPE\s+html/i.test(e)||/<\s*(html|body|div|span|ul|li|p|head|meta|link|script)\b/i.test(e)?"html":!/[{}<>]/.test(e)&&/\n/.test(e)&&/^(\s*[-\w]+\s*:\s*.+)$/m.test(e)?"yaml":/\barray\s*\(/i.test(e)||/=>/.test(e)||/\[\s*[^\]]*=>/m.test(e)?/=>\s*(string|int|float|array|object)\s*\(/i.test(e)||/\[\s*"?.+?"?\]\s*=>/m.test(e)?"phpVarDump":"phpArray":/(^|[\s\[{(])'(?:[^'\\]|\\.)*'/.test(e)||/\b(True|False|None)\b/.test(e)||/\((?:[^()]*,)[^()]*\)/.test(e)?"pythonRepr":/\/\/|#/.test(e)||/,\s*[\]}]/.test(e)||/(^|[^\\])'(?:[^'\\]|\\.)*'/.test(e)?"jsonish":"unknown"}function L(a,e="  "){const n=new Set(["SELECT","FROM","WHERE","JOIN","INNER","LEFT","RIGHT","FULL","OUTER","CROSS","ON","AS","AND","OR","GROUP","BY","ORDER","HAVING","LIMIT","OFFSET","UNION","ALL","DISTINCT","WITH","INSERT","INTO","VALUES","UPDATE","SET","DELETE","CREATE","TABLE"]),t=[];let i=0;const o=a;let r=!1,s=!1;for(;i<o.length;){const c=o[i];if(r){let u="'";for(i++;i<o.length;){const $=o[i++];if(u+=$,$==="'"&&o[i-2]!=="\\"){r=!1;break}}t.push({v:u,t:"string"});continue}if(s){let u='"';for(i++;i<o.length;){const $=o[i++];if(u+=$,$==='"'&&o[i-2]!=="\\"){s=!1;break}}t.push({v:u,t:"string"});continue}if(c==="'"){r=!0;continue}if(c==='"'){s=!0;continue}if(/\s/.test(c)){let u=i;for(;u<o.length&&/\s/.test(o[u]);)u++;t.push({v:" ",t:"space"}),i=u;continue}if(/[A-Za-z0-9_\.]/.test(c)){let u=i;for(;u<o.length&&/[A-Za-z0-9_\.]/.test(o[u]);)u++;t.push({v:o.slice(i,u),t:"word"}),i=u;continue}t.push({v:c,t:"symbol"}),i++}function g(c,u){return c&&c.t==="word"&&(!u||c.v.toUpperCase()===u)}function m(c){return c.t==="word"&&n.has(c.v.toUpperCase())?{...c,v:c.v.toUpperCase()}:c}for(let c=0;c<t.length;c++)t[c]=m(t[c]);let l="",h=0,p=!1,f=null,w="OTHER";const C=(c=h)=>{l+=`
`+e.repeat(c)},E=(c,u)=>g(t[c],u),b=()=>{for(;l.endsWith(" ");)l=l.slice(0,-1)};for(let c=0;c<t.length;c++)t[c],E(c,"GROUP")&&E(c+2,"BY")&&(t[c].v="GROUP BY",t[c+1]={v:" ",t:"space"},t[c+2]={v:"",t:"space"}),E(c,"ORDER")&&E(c+2,"BY")&&(t[c].v="ORDER BY",t[c+1]={v:" ",t:"space"},t[c+2]={v:"",t:"space"});for(let c=0;c<t.length;c++){const u=t[c],$=u.v;if(u.t==="space"){if(p)continue;!l.endsWith(" ")&&!l.endsWith(`
`)&&(l+=" ");continue}if(u.t==="word"){const d=$.toUpperCase();if(d==="SELECT"){l.trim()&&(b(),C(0)),l+="SELECT",w="SELECT",h=1,p=!0,f=1;continue}if(d==="FROM"){b(),C(0),l+="FROM",w="FROM",h=1,p=!0,f=1;continue}if(d==="WHERE"){b(),C(0),l+="WHERE",w="WHERE",h=1,p=!0,f=1;continue}if(d==="GROUP BY"){b(),C(0),l+="GROUP BY",w="GROUP BY",h=1,p=!0,f=1;continue}if(d==="ORDER BY"){b(),C(0),l+="ORDER BY",w="ORDER BY",h=1,p=!0,f=1;continue}if(d==="LIMIT"||d==="OFFSET"){b(),C(0),l+=d,w="OTHER",h=1,p=!0,f=1;continue}if(d==="JOIN"||d==="INNER"||d==="LEFT"||d==="RIGHT"||d==="FULL"||d==="CROSS"||d==="OUTER"){const x=t.slice(c,c+4).map(W=>W.v.toUpperCase()).join(" ");if(/\b(INNER|LEFT|RIGHT|FULL|CROSS|OUTER)?\s*JOIN\b/.test(x)){b(),C(0),l+=d,w="JOIN",p=!0,f=1;continue}}if(d==="ON"){b(),C(0),l+="ON",w="JOIN",p=!0,f=1;continue}if(p){for(;l.endsWith(" ");)l=l.slice(0,-1);C(f??h),p=!1,f=null}!l.endsWith(" ")&&!l.endsWith(`
`)&&(l+=" "),l+=$;continue}if(u.t==="symbol"){const d=$;if(d===","){l+=",",w==="SELECT"||w==="ORDER BY"||w==="GROUP BY"?C(h):l+=" ";continue}if(d==="("||d==="["){l+=d,h++,C(h);continue}if(d===")"||d==="]"){h=Math.max(0,h-1),C(h),l+=d;continue}if(d===";"){l+=";",C(0);continue}if(/=|<|>|!/.test(d)){!l.endsWith(" ")&&!l.endsWith(`
`)&&(l+=" "),l+=d,l+=" ";continue}l+=d;continue}if(u.t==="string"){!l.endsWith(" ")&&!l.endsWith(`
`)&&(l+=" "),l+=u.v;continue}}return l.endsWith(`
`)||(l+=`
`),l}function S(a,e="  "){let n="",t=0,i=0;const o=a.trim(),r=()=>{n+=`
`+e.repeat(t)};for(;i<o.length;){const s=o[i];if(s==="{"){n=n.trimEnd(),n+=" {",t++,r(),i++;continue}if(s==="}"){n=n.trimEnd();const g=(()=>{for(let m=n.length-1;m>=0;m--){const l=n[m];if(!/\s/.test(l))return l}return""})();for(g&&g!==";"&&g!=="{"&&g!=="}"&&(n+=";"),n.endsWith(`
`)||(n+=`
`),t=Math.max(0,t-1),n+=e.repeat(t)+"}",i+1<o.length&&(n+=`
`),i++;i<o.length&&/\s/.test(o[i]);)i++;continue}if(s===";"){for(n=n.trimEnd(),n+=`;
`,n+=e.repeat(t),i++;i<o.length&&/\s/.test(o[i]);)i++;continue}if(s===":"){for(n=n.trimEnd(),n+=": ",i++;i<o.length&&o[i]===" ";)i++;continue}if(/\s/.test(s)){!n.endsWith(" ")&&!n.endsWith(`
`)&&(n+=" "),i++;continue}n+=s,i++}return n.endsWith(`
`)||(n+=`
`),n}const A=new Set(["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"]);function B(a){const e=[],n=/(\w[\w:-]*)\s*=\s*("[^"]*"|'[^']*'|[^\s>]+)/g;let t;for(;t=n.exec(a);){const i=t[1],o=t[2];e.push(`${i}=${o}`)}return e.join(" ")}function M(a,e="  "){const n=[];let t=0;const i=/<[^>]+>/g;let o;for(;o=i.exec(a);){const m=o.index;if(m>t){const l=a.slice(t,m);n.push({type:"text",value:l})}n.push({type:"tag",value:o[0]}),t=i.lastIndex}t<a.length&&n.push({type:"text",value:a.slice(t)});let r=0,s="";function g(m=r){s+=`
`+e.repeat(m)}for(let m=0;m<n.length;m++){const l=n[m];if(l.type==="text"){const W=l.value.replace(/\s+/g," ").trim();if(!W)continue;s.endsWith(`
`)||(s+=" "),s+=W;continue}const h=l.value,p=/^<\//.test(h);if(/^<!--/.test(h)){g(),s+=h;continue}const w=/^<\/?\s*([a-zA-Z0-9:-]+)/.exec(h),C=w?w[1].toLowerCase():"",E=/\/>$/.test(h)||A.has(C);if(p){r=Math.max(0,r-1),g(r),s+=`</${C}>`;continue}const b=h.replace(/^<\s*[a-zA-Z0-9:-]+\s*|\/?\s*>$/g,""),c=b?B(b):"",u=n[m+1],$=n[m+2],d=u&&u.type==="text"&&u.value.trim().length>0&&!/<|>/.test(u.value),x=$&&$.type==="tag"&&new RegExp(`^</s*${C}[^>]*>`).test($.value);if(!s.endsWith(`
`)&&s.length>0&&g(),s+=`<${C}${c?" "+c:""}>`,!E){if(d&&x){s+=u.value.trim(),s+=`</${C}>`,m+=2;continue}r++}}return s.endsWith(`
`)||(s+=`
`),s}function D(a){const e=[],n=/(\w[\w:-]*)\s*=\s*("[^"]*"|'[^']*'|[^\s>]+)/g;let t;for(;t=n.exec(a);){const i=t[1],o=t[2];e.push(`${i}=${o}`)}return e.join(" ")}function U(a,e="  "){const n=[];let t=0;const i=/<[^>]+>/g;let o;for(;o=i.exec(a);){const h=o.index;if(h>t){const p=a.slice(t,h);n.push({type:"text",value:p})}n.push({type:"tag",value:o[0]}),t=i.lastIndex}t<a.length&&n.push({type:"text",value:a.slice(t)});let r=0,s="";const g=[];let m=!1;const l=(h=r)=>{s+=`
`+e.repeat(h)};for(let h=0;h<n.length;h++){const p=n[h];if(p.type==="text"){const $=p.value.replace(/\s+/g," ").trim();if(!$)continue;s+=$,m=!0;continue}const f=p.value,w=/^<\//.test(f),C=/^<\?xml/.test(f)||/^<!--/.test(f),E=/\/>$/.test(f);if(C){!s.endsWith(`
`)&&s.length&&l(0),s+=f,m=!1;continue}if(w){r=Math.max(0,r-1);const $=/^<\s*\/\s*([\w:-]+)/.exec(f)?.[1]||"";g[g.length-1]===$&&m&&!s.endsWith(`
`)?s+=`</${$}>`:(l(r),s+=`</${$}>`),g.length&&g.pop(),m=!1;continue}const b=/^<\s*([\w:-]+)/.exec(f)?.[1]||"",c=f.replace(/^<\s*[\w:-]+\s*|\/?\s*>$/g,""),u=c?D(c):"";!s.endsWith(`
`)&&s.length&&l(),s+=`<${b}${u?" "+u:""}${E?" /":""}>`,E||(r++,g.push(b)),m=!1}return s.endsWith(`
`)||(s+=`
`),s}function j(a){const e=[];let n=0,t="",i="",o=!0,r=!1,s=!1,g=!1;const m=()=>{const l=t.trim(),h=i.trim();l&&e.push([l,h]),t="",i="",o=!0};for(;n<a.length;){const l=a[n++];if(g){o?t+=l:i+=l,g=!1;continue}if(l==="\\"){o?t+=l:i+=l,g=!0;continue}if(l==='"'&&!r){o?t+=l:i+=l,s=!s;continue}if(l==="'"&&!s){o?t+=l:i+=l,r=!r;continue}if(!r&&!s){if(l===":"&&o){o=!1;continue}if(l===","){m();continue}}o?t+=l:i+=l}return m(),e}function F(a,e="  "){const n=a.split(/\r?\n/),t=[];for(const i of n){const o=/^\s*([A-Za-z0-9_-]+)\s*:\s*\{([^}]*)\}\s*$/.exec(i);if(o){const r=o[1],s=o[2];t.push(`${r}:`);const g=j(s);for(const[m,l]of g)t.push(`${e}${m.trim()}: ${l.trim()}`)}else t.push(i)}return t.join(`
`)+`
`}function P(a,e){if(!a.includes("array(")||!a.includes("=>"))return a;let n=a;n=n.replace(/array\s*\(\s*(\d+)\s*\)\s*\{/g,"array($1) {"),n=n.replace(/([^\s])=>/g,"$1 =>"),n=n.replace(/=>([^\s])/g,"=> $1"),n=n.replace(/(\]\s*=>\s*)array\(/g,`$1
array(`),n=n.replace(/(\]\s*=>\s*)object/g,`$1
object`),n=n.replace(/(string\(\d+\))"([^"]*)"/g,'$1 "$2"'),n=n.replace(/(\]\s*=>\s*[^[}]+)(\[)/g,`$1
$2`),n=n.replace(/(\{)([^}\n])/g,`$1
$2`),n=n.replace(/([^{\n])(\})/g,`$1
$2`),n=n.replace(/(\})(\})/g,`$1
$2`);const t=n.split(`
`),i=[];let o=0;for(let r=0;r<t.length;r++){let s=t[r].trim();if(!s)continue;if(s.match(/^array\(\d+\)$/)&&r+1<t.length&&t[r+1].trim()==="{"){s=s+" {",r++,o++,i.push(e.repeat(Math.max(0,o-1))+s);continue}if(s==="}"){o=Math.max(0,o-1),i.push(e.repeat(o)+s);continue}if(/\]\s*=>\s*$/.test(s)&&r+1<t.length){const l=t[r+1].trim();/^(int\(|string\(|float\(|bool\(|resource\()/.test(l)&&(s=`${s} ${l}`,r++)}if(/array\(\d+\)\s*$/.test(s)&&r+1<t.length&&t[r+1].trim()==="{"){s=`${s} {`,r++,i.push(e.repeat(o)+s),o++;continue}if(/object\([^)]*\)\s*#?\d*\s*\(\d+\)\s*$/.test(s)&&r+1<t.length&&t[r+1].trim()==="{"){s=`${s} {`,r++,i.push(e.repeat(o)+s),o++;continue}i.push(e.repeat(o)+s);const g=(s.match(/\{/g)||[]).length,m=(s.match(/\}/g)||[]).length;o+=g-m,o=Math.max(0,o)}return i.join(`
`)}function O(a,e){const n=typeof performance<"u"?performance.now():Date.now();try{const t=e.useTabs?"	":" ".repeat(e.indent),i=N(a),o=z(a);let r;return i==="phpVarDump"?r=P(a,t):i==="sql"?r=L(a,t):i==="css"?r=S(a,t):i==="html"?r=M(a,t):i==="xml"?r=U(a,t):i==="yaml"?r=F(a,t):r=v.format(a,t),i!=="phpVarDump"&&(r=Y(r),r=H(r)),/(^|\n)\s*(def|class)\b.*:\s*$/m.test(a)&&(r=G(r,t)),r&&!r.endsWith(`
`)&&(r+=`
`),{output:r,diagnostics:o,timeMs:(typeof performance<"u"?performance.now():Date.now())-n}}catch(t){return{output:a,diagnostics:{warnings:[`Formatting error: ${t instanceof Error?t.message:String(t)}`]},timeMs:(typeof performance<"u"?performance.now():Date.now())-n}}}function z(a){const e=[];let n=!1;const t=[],i={"(":")","[":"]","{":"}"},o=new Set(["(","[","{"]),r=new Set([")","]","}"]);let s=!1,g="",m=!1;for(let l=0;l<a.length;l++){const h=a[l];if(m){m=!1;continue}if(h==="\\"){m=!0;continue}if(!s&&(h==='"'||h==="'")){s=!0,g=h;continue}if(s&&h===g){s=!1,g="";continue}if(!s){if(o.has(h))t.push(h);else if(r.has(h))if(t.length===0)n=!0,e.push(`Unexpected closing bracket: ${h} at position ${l}`);else{const p=t.pop();i[p]!==h&&(n=!0,e.push(`Mismatched brackets: ${p} closed with ${h} at position ${l}`))}}}return t.length>0&&(n=!0,e.push(`Unclosed brackets: ${t.join(", ")}`)),{warnings:e,unbalancedBrackets:n}}function Y(a){let e="",n=0,t=!1,i=!1,o=!1;for(let r=0;r<a.length;r++){const s=a[r];if(o){e+=s,o=!1;continue}if((t||i)&&s==="\\"){e+=s,o=!0;continue}if(!i&&s==="'"&&!t){t=!0,e+=s;continue}if(t&&s==="'"){t=!1,e+=s;continue}if(!t&&s==='"'&&!i){i=!0,e+=s;continue}if(i&&s==='"'){i=!1,e+=s;continue}if(t||i){e+=s;continue}const g=s==="{"||s==="["||s==="(";if(s==="}"||s==="]"||s===")"){e+=s,n=Math.max(0,n-1);let l=r+1;for(;l<a.length&&/\s/.test(a[l]);)l++;if(n===0&&l<a.length){const h=a[l];(h==="{"||h==="["||h==="(")&&!(s===")"&&e.includes("function ")&&e.substring(e.lastIndexOf("function ")).includes("("))&&!e.endsWith(`
`)&&(e+=`
`)}continue}if(g){n++,e+=s;continue}e+=s}return e}function H(a){let e="",n=0,t=!1,i=!1,o=!1;const r=s=>/[A-Za-z_$]/.test(s);for(;n<a.length;){const s=a[n];if(e+=s,o){o=!1,n++;continue}if((t||i)&&s==="\\"){o=!0,n++;continue}if(!i&&s==="'"&&!t){t=!0,n++;continue}if(t&&s==="'"){t=!1,n++;continue}if(!t&&s==='"'&&!i){i=!0,n++;continue}if(i&&s==='"'){i=!1,n++;continue}if(!t&&!i&&s==="}"){let g=n+1;for(;g<a.length&&/\s/.test(a[g]);)g++;if(g<a.length&&r(a[g])&&!e.endsWith(`
`)){let m=e.length-1;for(;m>=0&&e[m]!==`
`;)m--;let l="",h=m+1;for(;h<e.length&&(e[h]===" "||e[h]==="	");)l+=e[h],h++;e+=`
`+l}}n++}return e}function G(a,e){const n=a.split(`
`);let t=[],i=!1;for(let r=0;r<n.length;r++){let s=n[r];const g=s.trim();if(i&&g.length>0){const m=(s.match(/^\s*/)||[""])[0];m.length===0?s=e+s:m.startsWith(e)||(s=e+s.slice(m.length)),i=!1}t.push(s),g.endsWith(":")?i=!0:g.length>0&&(i=!1)}let o=t.join(`
`);return o.endsWith(`
`)||(o+=`
`),o}const T=5e3;let I=null,k=!1;self.onmessage=function(a){const e=a.data;if("type"in e&&e.type==="cancel"){I===e.id&&(k=!0);return}const n=e;I&&I!==n.id&&(k=!0),I=n.id,k=!1,Z(n)};async function Z(a){const{id:e,text:n,options:t}=a;try{const i=n.length;if(i<=T){if(k)return;const g=O(n,t);if(!k){const m={id:e,type:"result",result:g};self.postMessage(m)}return}const o=Math.ceil(i/T);let r=0;y(e,0,o);const s=await V(n,t,g=>{k||(r=Math.floor(g*o),y(e,r,o))});if(!k){y(e,o,o);const g={id:e,type:"result",result:s};self.postMessage(g)}}catch(i){if(!k){const o={id:e,type:"error",error:i instanceof Error?i.message:String(i)};self.postMessage(o)}}}async function V(a,e,n){if(n(.1),await R(10),k)throw new Error("Cancelled");if(n(.3),await R(10),k)throw new Error("Cancelled");if(n(.7),await R(10),k)throw new Error("Cancelled");const t=O(a,e);return n(.9),await R(5),n(1),t}function y(a,e,n){const t={id:a,type:"progress",processed:e,total:n};self.postMessage(t)}function R(a){return new Promise(e=>setTimeout(e,a))}})();
