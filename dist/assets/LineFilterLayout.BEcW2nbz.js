import{j as a}from"./jsx-runtime.9DypCmAh.js";import{c as qs,g as Vs,r as O,R as ns}from"./index.eCxJ45ll.js";import{u as ie}from"./index.et05KHOM.js";import{a as De,m as os}from"./index.Bda8kKQR.js";const $s=5,Nr=6,Sr=10;let zs=(_,l,f,d)=>(_.events=_.events||{},_.events[f+Sr]||(_.events[f+Sr]=d(k=>{_.events[f].reduceRight((S,E)=>(E(S),S),{shared:{},...k})})),_.events[f]=_.events[f]||[],_.events[f].push(l),()=>{let k=_.events[f],S=k.indexOf(l);k.splice(S,1),k.length||(delete _.events[f],_.events[f+Sr](),delete _.events[f+Sr])}),Us=1e3,Hs=(_,l)=>zs(_,d=>{let k=l(d);k&&_.events[Nr].push(k)},$s,d=>{let k=_.listen;_.listen=(...E)=>(!_.lc&&!_.active&&(_.active=!0,d()),k(...E));let S=_.off;return _.events[Nr]=[],_.off=()=>{S(),setTimeout(()=>{if(_.active&&!_.lc){_.active=!1;for(let E of _.events[Nr])E();_.events[Nr]=[]}},Us)},()=>{_.listen=k,_.off=S}}),Ws=(_,l,f)=>{Array.isArray(_)||(_=[_]);let d,k=0,S=()=>{let q=_.map(V=>V.get());if(d===void 0||q.some((V,H)=>V!==d[H])){let V=++k;d=q;let H=l(...q);H&&H.then&&H.t?H.then(Y=>{V===k&&E.set(Y)}):E.set(H)}},E=De(void 0,Math.max(..._.map(q=>q.l))+1),B=S;return Hs(E,()=>{let q=_.map(V=>V.listen(B,-1/E.l));return S(),()=>{for(let V of q)V()}}),E},Qt=(_,l)=>Ws(_,l);var Er={exports:{}},Ys=Er.exports,ss;function Xs(){return ss||(ss=1,function(_,l){(function(f,d){_.exports=d()})(Ys,function(){var f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])})(e,t)},d=function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function k(e,t,r){for(var n,s=0,i=t.length;s<i;s++)!n&&s in t||((n=n||Array.prototype.slice.call(t,0,s))[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}var S=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:qs,E=Object.keys,B=Array.isArray;function q(e,t){return typeof t!="object"||E(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||S.Promise||(S.Promise=Promise);var V=Object.getPrototypeOf,H={}.hasOwnProperty;function Y(e,t){return H.call(e,t)}function M(e,t){typeof t=="function"&&(t=t(V(e))),(typeof Reflect>"u"?E:Reflect.ownKeys)(t).forEach(function(r){te(e,r,t[r])})}var J=Object.defineProperty;function te(e,t,r,n){J(e,t,q(r&&Y(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function le(e){return{from:function(t){return e.prototype=Object.create(t.prototype),te(e.prototype,"constructor",e),{extend:M.bind(null,e.prototype)}}}}var me=Object.getOwnPropertyDescriptor,he=[].slice;function be(e,t,r){return he.call(e,t,r)}function ue(e,t){return t(e)}function ye(e){if(!e)throw new Error("Assertion Failed")}function xe(e){S.setImmediate?setImmediate(e):setTimeout(e,0)}function we(e,t){if(typeof t=="string"&&Y(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],n=0,s=t.length;n<s;++n){var i=we(e,t[n]);r.push(i)}return r}var o=t.indexOf(".");if(o!==-1){var c=e[t.substr(0,o)];return c==null?void 0:we(c,t.substr(o+1))}}function ce(e,t,r){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){ye(typeof r!="string"&&"length"in r);for(var n=0,s=t.length;n<s;++n)ce(e,t[n],r[n])}else{var i,o,c=t.indexOf(".");c!==-1?(i=t.substr(0,c),(o=t.substr(c+1))===""?r===void 0?B(e)&&!isNaN(parseInt(i))?e.splice(i,1):delete e[i]:e[i]=r:ce(c=!(c=e[i])||!Y(e,i)?e[i]={}:c,o,r)):r===void 0?B(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function Ne(e){var t,r={};for(t in e)Y(e,t)&&(r[t]=e[t]);return r}var Ke=[].concat;function qe(e){return Ke.apply([],e)}var pt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(qe([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return S[e]}),ae=new Set(pt.map(function(e){return S[e]})),G=null;function T(e){return G=new WeakMap,e=function t(r){if(!r||typeof r!="object")return r;var n=G.get(r);if(n)return n;if(B(r)){n=[],G.set(r,n);for(var s=0,i=r.length;s<i;++s)n.push(t(r[s]))}else if(ae.has(r.constructor))n=r;else{var o,c=V(r);for(o in n=c===Object.prototype?{}:Object.create(c),G.set(r,n),r)Y(r,o)&&(n[o]=t(r[o]))}return n}(e),G=null,e}var W={}.toString;function X(e){return W.call(e).slice(8,-1)}var Q=typeof Symbol<"u"?Symbol.iterator:"@@iterator",z=typeof Q=="symbol"?function(e){var t;return e!=null&&(t=e[Q])&&t.apply(e)}:function(){return null};function re(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var Ie={};function Je(e){var t,r,n,s;if(arguments.length===1){if(B(e))return e.slice();if(this===Ie&&typeof e=="string")return[e];if(s=z(e)){for(r=[];!(n=s.next()).done;)r.push(n.value);return r}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(r=new Array(t);t--;)r[t]=e[t];return r}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var Or=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Rt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ue=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Rt),cs={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ct(e,t){this.name=e,this.message=t}function kn(e,t){return e+". Errors: "+Object.keys(t).map(function(r){return t[r].toString()}).filter(function(r,n,s){return s.indexOf(r)===n}).join(`
`)}function Zt(e,t,r,n){this.failures=t,this.failedKeys=n,this.successCount=r,this.message=kn(e,t)}function Nt(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(r){return t[r]}),this.failuresByPos=t,this.message=kn(e,this.failures)}le(Ct).from(Error).extend({toString:function(){return this.name+": "+this.message}}),le(Zt).from(Ct),le(Nt).from(Ct);var Pr=Ue.reduce(function(e,t){return e[t]=t+"Error",e},{}),us=Ct,U=Ue.reduce(function(e,t){var r=t+"Error";function n(s,i){this.name=r,s?typeof s=="string"?(this.message="".concat(s).concat(i?`
 `+i:""),this.inner=i||null):typeof s=="object"&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=cs[t]||r,this.inner=null)}return le(n).from(us),e[t]=n,e},{});U.Syntax=SyntaxError,U.Type=TypeError,U.Range=RangeError;var jn=Rt.reduce(function(e,t){return e[t+"Error"]=U[t],e},{}),Jt=Ue.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=U[t]),e},{});function fe(){}function Kt(e){return e}function ds(e,t){return e==null||e===Kt?t:function(r){return t(e(r))}}function ht(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function fs(e,t){return e===fe?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?ht(n,this.onsuccess):n),s&&(this.onerror=this.onerror?ht(s,this.onerror):s),i!==void 0?i:r}}function hs(e,t){return e===fe?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?ht(r,this.onsuccess):r),n&&(this.onerror=this.onerror?ht(n,this.onerror):n)}}function ps(e,t){return e===fe?t:function(r){var n=e.apply(this,arguments);q(r,n);var s=this.onsuccess,i=this.onerror;return this.onsuccess=null,this.onerror=null,r=t.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?ht(s,this.onsuccess):s),i&&(this.onerror=this.onerror?ht(i,this.onerror):i),n===void 0?r===void 0?void 0:r:q(n,r)}}function ms(e,t){return e===fe?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Lr(e,t){return e===fe?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,s=arguments.length,i=new Array(s);s--;)i[s]=arguments[s];return r.then(function(){return t.apply(n,i)})}return t.apply(this,arguments)}}Jt.ModifyError=Zt,Jt.DexieError=Ct,Jt.BulkError=Nt;var Xe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function _n(e){Xe=e}var Mt={},Cn=100,pt=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,V(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,V(t),e]}(),Rt=pt[0],Ue=pt[1],pt=pt[2],Ue=Ue&&Ue.then,mt=Rt&&Rt.constructor,Ar=!!pt,Bt=function(e,t){qt.push([e,t]),er&&(queueMicrotask(gs),er=!1)},Ir=!0,er=!0,yt=[],tr=[],Tr=Kt,it={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:fe,pgp:!1,env:{},finalize:fe},$=it,qt=[],gt=0,rr=[];function K(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=$;if(typeof e!="function"){if(e!==Mt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Mr(this,this._value))}this._state=null,this._value=null,++t.ref,function r(n,s){try{s(function(i){if(n._state===null){if(i===n)throw new TypeError("A promise cannot be resolved with itself.");var o=n._lib&&St();i&&typeof i.then=="function"?r(n,function(c,h){i instanceof K?i._then(c,h):i.then(c,h)}):(n._state=!0,n._value=i,Sn(n)),o&&Et()}},Mr.bind(null,n))}catch(i){Mr(n,i)}}(this,e)}var Kr={get:function(){var e=$,t=ar;function r(n,s){var i=this,o=!e.global&&(e!==$||t!==ar),c=o&&!ot(),h=new K(function(m,v){Rr(i,new Nn(Fn(n,e,o,c),Fn(s,e,o,c),m,v,e))});return this._consoleTask&&(h._consoleTask=this._consoleTask),h}return r.prototype=Mt,r},set:function(e){te(this,"then",e&&e.prototype===Mt?Kr:{get:function(){return e},set:Kr.set})}};function Nn(e,t,r,n,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=n,this.psd=s}function Mr(e,t){var r,n;tr.push(t),e._state===null&&(r=e._lib&&St(),t=Tr(t),e._state=!1,e._value=t,n=e,yt.some(function(s){return s._value===n._value})||yt.push(n),Sn(e),r&&Et())}function Sn(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)Rr(e,t[r]);var s=e._PSD;--s.ref||s.finalize(),gt===0&&(++gt,Bt(function(){--gt==0&&Br()},[]))}function Rr(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++gt,Bt(ys,[r,e,t])}else e._listeners.push(t)}function ys(e,t,r){try{var n,s=t._value;!t._state&&tr.length&&(tr=[]),n=Xe&&t._consoleTask?t._consoleTask.run(function(){return e(s)}):e(s),t._state||tr.indexOf(s)!==-1||function(i){for(var o=yt.length;o;)if(yt[--o]._value===i._value)return yt.splice(o,1)}(t),r.resolve(n)}catch(i){r.reject(i)}finally{--gt==0&&Br(),--r.psd.ref||r.psd.finalize()}}function gs(){vt(it,function(){St()&&Et()})}function St(){var e=Ir;return er=Ir=!1,e}function Et(){var e,t,r;do for(;0<qt.length;)for(e=qt,qt=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}while(0<qt.length);er=Ir=!0}function Br(){var e=yt;yt=[],e.forEach(function(n){n._PSD.onunhandled.call(null,n._value,n)});for(var t=rr.slice(0),r=t.length;r;)t[--r]()}function nr(e){return new K(Mt,!1,e)}function ge(e,t){var r=$;return function(){var n=St(),s=$;try{return lt(r,!0),e.apply(this,arguments)}catch(i){t&&t(i)}finally{lt(s,!1),n&&Et()}}}M(K.prototype,{then:Kr,_then:function(e,t){Rr(this,new Nn(null,null,e,t,$))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,r=arguments[1];return typeof t=="function"?this.then(null,function(n){return(n instanceof t?r:nr)(n)}):this.then(null,function(n){return(n&&n.name===t?r:nr)(n)})},finally:function(e){return this.then(function(t){return K.resolve(e()).then(function(){return t})},function(t){return K.resolve(e()).then(function(){return nr(t)})})},timeout:function(e,t){var r=this;return e<1/0?new K(function(n,s){var i=setTimeout(function(){return s(new U.Timeout(t))},e);r.then(n,s).finally(clearTimeout.bind(null,i))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&te(K.prototype,Symbol.toStringTag,"Dexie.Promise"),it.env=En(),M(K,{all:function(){var e=Je.apply(null,arguments).map(or);return new K(function(t,r){e.length===0&&t([]);var n=e.length;e.forEach(function(s,i){return K.resolve(s).then(function(o){e[i]=o,--n||t(e)},r)})})},resolve:function(e){return e instanceof K?e:e&&typeof e.then=="function"?new K(function(t,r){e.then(t,r)}):new K(Mt,!0,e)},reject:nr,race:function(){var e=Je.apply(null,arguments).map(or);return new K(function(t,r){e.map(function(n){return K.resolve(n).then(t,r)})})},PSD:{get:function(){return $},set:function(e){return $=e}},totalEchoes:{get:function(){return ar}},newPSD:at,usePSD:vt,scheduler:{get:function(){return Bt},set:function(e){Bt=e}},rejectionMapper:{get:function(){return Tr},set:function(e){Tr=e}},follow:function(e,t){return new K(function(r,n){return at(function(s,i){var o=$;o.unhandleds=[],o.onunhandled=i,o.finalize=ht(function(){var c,h=this;c=function(){h.unhandleds.length===0?s():i(h.unhandleds[0])},rr.push(function m(){c(),rr.splice(rr.indexOf(m),1)}),++gt,Bt(function(){--gt==0&&Br()},[])},o.finalize),e()},t,r,n)})}}),mt&&(mt.allSettled&&te(K,"allSettled",function(){var e=Je.apply(null,arguments).map(or);return new K(function(t){e.length===0&&t([]);var r=e.length,n=new Array(r);e.forEach(function(s,i){return K.resolve(s).then(function(o){return n[i]={status:"fulfilled",value:o}},function(o){return n[i]={status:"rejected",reason:o}}).then(function(){return--r||t(n)})})})}),mt.any&&typeof AggregateError<"u"&&te(K,"any",function(){var e=Je.apply(null,arguments).map(or);return new K(function(t,r){e.length===0&&r(new AggregateError([]));var n=e.length,s=new Array(n);e.forEach(function(i,o){return K.resolve(i).then(function(c){return t(c)},function(c){s[o]=c,--n||r(new AggregateError(s))})})})}),mt.withResolvers&&(K.withResolvers=mt.withResolvers));var Ee={awaits:0,echoes:0,id:0},vs=0,sr=[],ir=0,ar=0,bs=0;function at(e,t,r,n){var s=$,i=Object.create(s);return i.parent=s,i.ref=0,i.global=!1,i.id=++bs,it.env,i.env=Ar?{Promise:K,PromiseProp:{value:K,configurable:!0,writable:!0},all:K.all,race:K.race,allSettled:K.allSettled,any:K.any,resolve:K.resolve,reject:K.reject}:{},t&&q(i,t),++s.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()},n=vt(i,e,r,n),i.ref===0&&i.finalize(),n}function Ft(){return Ee.id||(Ee.id=++vs),++Ee.awaits,Ee.echoes+=Cn,Ee.id}function ot(){return!!Ee.awaits&&(--Ee.awaits==0&&(Ee.id=0),Ee.echoes=Ee.awaits*Cn,!0)}function or(e){return Ee.echoes&&e&&e.constructor===mt?(Ft(),e.then(function(t){return ot(),t},function(t){return ot(),je(t)})):e}function xs(){var e=sr[sr.length-1];sr.pop(),lt(e,!1)}function lt(e,t){var r,n=$;(t?!Ee.echoes||ir++&&e===$:!ir||--ir&&e===$)||queueMicrotask(t?function(s){++ar,Ee.echoes&&--Ee.echoes!=0||(Ee.echoes=Ee.awaits=Ee.id=0),sr.push($),lt(s,!0)}.bind(null,e):xs),e!==$&&($=e,n===it&&(it.env=En()),Ar&&(r=it.env.Promise,t=e.env,(n.global||e.global)&&(Object.defineProperty(S,"Promise",t.PromiseProp),r.all=t.all,r.race=t.race,r.resolve=t.resolve,r.reject=t.reject,t.allSettled&&(r.allSettled=t.allSettled),t.any&&(r.any=t.any))))}function En(){var e=S.Promise;return Ar?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(S,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function vt(e,t,r,n,s){var i=$;try{return lt(e,!0),t(r,n,s)}finally{lt(i,!1)}}function Fn(e,t,r,n){return typeof e!="function"?e:function(){var s=$;r&&Ft(),lt(t,!0);try{return e.apply(this,arguments)}finally{lt(s,!1),n&&queueMicrotask(ot)}}}function qr(e){Promise===mt&&Ee.echoes===0?ir===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Ue).indexOf("[native code]")===-1&&(Ft=ot=fe);var je=K.reject,bt="ï¿¿",et="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Dn="String expected.",Dt=[],lr="__dbnames",Vr="readonly",$r="readwrite";function xt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var On={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function cr(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=T(t))[e],t}}function Pn(){throw U.Type()}function oe(e,t){try{var r=Ln(e),n=Ln(t);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(s,i){for(var o=s.length,c=i.length,h=o<c?o:c,m=0;m<h;++m)if(s[m]!==i[m])return s[m]<i[m]?-1:1;return o===c?0:o<c?-1:1}(An(e),An(t));case"Array":return function(s,i){for(var o=s.length,c=i.length,h=o<c?o:c,m=0;m<h;++m){var v=oe(s[m],i[m]);if(v!==0)return v}return o===c?0:o<c?-1:1}(e,t)}}catch{}return NaN}function Ln(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=X(e),e==="ArrayBuffer"?"binary":e)}function An(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var In=(pe.prototype._trans=function(e,t,r){var n=this._tx||$.trans,s=this.name,i=Xe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function o(m,v,u){if(!u.schema[s])throw new U.NotFound("Table "+s+" not part of transaction");return t(u.idbtrans,u)}var c=St();try{var h=n&&n.db._novip===this.db._novip?n===$.trans?n._promise(e,o,r):at(function(){return n._promise(e,o,r)},{trans:n,transless:$.transless||$}):function m(v,u,x,p){if(v.idbdb&&(v._state.openComplete||$.letThrough||v._vip)){var g=v._createTransaction(u,x,v._dbSchema);try{g.create(),v._state.PR1398_maxLoop=3}catch(b){return b.name===Pr.InvalidState&&v.isOpen()&&0<--v._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),v.close({disableAutoOpen:!1}),v.open().then(function(){return m(v,u,x,p)})):je(b)}return g._promise(u,function(b,y){return at(function(){return $.trans=g,p(b,y,g)})}).then(function(b){if(u==="readwrite")try{g.idbtrans.commit()}catch{}return u==="readonly"?b:g._completion.then(function(){return b})})}if(v._state.openComplete)return je(new U.DatabaseClosed(v._state.dbOpenError));if(!v._state.isBeingOpened){if(!v._state.autoOpen)return je(new U.DatabaseClosed);v.open().catch(fe)}return v._state.dbReadyPromise.then(function(){return m(v,u,x,p)})}(this.db,e,[this.name],o);return i&&(h._consoleTask=i,h=h.catch(function(m){return console.trace(m),je(m)})),h}finally{c&&Et()}},pe.prototype.get=function(e,t){var r=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?je(new U.Type("Invalid argument to Table.get()")):this._trans("readonly",function(n){return r.core.get({trans:n,key:e}).then(function(s){return r.hook.reading.fire(s)})}).then(t)},pe.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(B(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=E(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(c){if(c.compound&&t.every(function(m){return 0<=c.keyPath.indexOf(m)})){for(var h=0;h<t.length;++h)if(t.indexOf(c.keyPath[h])===-1)return!1;return!0}return!1}).sort(function(c,h){return c.keyPath.length-h.keyPath.length})[0];if(r&&this.db._maxKey!==bt){var i=r.keyPath.slice(0,t.length);return this.where(i).equals(i.map(function(h){return e[h]}))}!r&&Xe&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var n=this.schema.idxByName;function s(c,h){return oe(c,h)===0}var o=t.reduce(function(u,h){var m=u[0],v=u[1],u=n[h],x=e[h];return[m||u,m||!u?xt(v,u&&u.multi?function(p){return p=we(p,h),B(p)&&p.some(function(g){return s(x,g)})}:function(p){return s(x,we(p,h))}):v]},[null,null]),i=o[0],o=o[1];return i?this.where(i.name).equals(e[i.keyPath]).filter(o):r?this.filter(o):this.where(t).equals("")},pe.prototype.filter=function(e){return this.toCollection().and(e)},pe.prototype.count=function(e){return this.toCollection().count(e)},pe.prototype.offset=function(e){return this.toCollection().offset(e)},pe.prototype.limit=function(e){return this.toCollection().limit(e)},pe.prototype.each=function(e){return this.toCollection().each(e)},pe.prototype.toArray=function(e){return this.toCollection().toArray(e)},pe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},pe.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,B(e)?"[".concat(e.join("+"),"]"):e))},pe.prototype.reverse=function(){return this.toCollection().reverse()},pe.prototype.mapToClass=function(e){var t,r=this.db,n=this.name;function s(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Pn&&(function(h,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");function v(){this.constructor=h}f(h,m),h.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}(s,t=e),Object.defineProperty(s.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),s.prototype.table=function(){return n},e=s);for(var i=new Set,o=e.prototype;o;o=V(o))Object.getOwnPropertyNames(o).forEach(function(h){return i.add(h)});function c(h){if(!h)return h;var m,v=Object.create(e.prototype);for(m in h)if(!i.has(m))try{v[m]=h[m]}catch{}return v}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=c,this.hook("reading",c),e},pe.prototype.defineClass=function(){return this.mapToClass(function(e){q(this,e)})},pe.prototype.add=function(e,t){var r=this,n=this.schema.primKey,s=n.auto,i=n.keyPath,o=e;return i&&s&&(o=cr(i)(e)),this._trans("readwrite",function(c){return r.core.mutate({trans:c,type:"add",keys:t!=null?[t]:null,values:[o]})}).then(function(c){return c.numFailures?K.reject(c.failures[0]):c.lastResult}).then(function(c){if(i)try{ce(e,i,c)}catch{}return c})},pe.prototype.update=function(e,t){return typeof e!="object"||B(e)?this.where(":id").equals(e).modify(t):(e=we(e,this.schema.primKey.keyPath),e===void 0?je(new U.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},pe.prototype.put=function(e,t){var r=this,n=this.schema.primKey,s=n.auto,i=n.keyPath,o=e;return i&&s&&(o=cr(i)(e)),this._trans("readwrite",function(c){return r.core.mutate({trans:c,type:"put",values:[o],keys:t!=null?[t]:null})}).then(function(c){return c.numFailures?K.reject(c.failures[0]):c.lastResult}).then(function(c){if(i)try{ce(e,i,c)}catch{}return c})},pe.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?K.reject(r.failures[0]):void 0})},pe.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:On})}).then(function(t){return t.numFailures?K.reject(t.failures[0]):void 0})},pe.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(r){return t.core.getMany({keys:e,trans:r}).then(function(n){return n.map(function(s){return t.hook.reading.fire(s)})})})},pe.prototype.bulkAdd=function(e,t,r){var n=this,s=Array.isArray(t)?t:void 0,i=(r=r||(s?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(o){var m=n.schema.primKey,c=m.auto,m=m.keyPath;if(m&&s)throw new U.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new U.InvalidArgument("Arguments objects and keys must have the same length");var h=e.length,m=m&&c?e.map(cr(m)):e;return n.core.mutate({trans:o,type:"add",keys:s,values:m,wantResults:i}).then(function(g){var u=g.numFailures,x=g.results,p=g.lastResult,g=g.failures;if(u===0)return i?x:p;throw new Nt("".concat(n.name,".bulkAdd(): ").concat(u," of ").concat(h," operations failed"),g)})})},pe.prototype.bulkPut=function(e,t,r){var n=this,s=Array.isArray(t)?t:void 0,i=(r=r||(s?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(o){var m=n.schema.primKey,c=m.auto,m=m.keyPath;if(m&&s)throw new U.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new U.InvalidArgument("Arguments objects and keys must have the same length");var h=e.length,m=m&&c?e.map(cr(m)):e;return n.core.mutate({trans:o,type:"put",keys:s,values:m,wantResults:i}).then(function(g){var u=g.numFailures,x=g.results,p=g.lastResult,g=g.failures;if(u===0)return i?x:p;throw new Nt("".concat(n.name,".bulkPut(): ").concat(u," of ").concat(h," operations failed"),g)})})},pe.prototype.bulkUpdate=function(e){var t=this,r=this.core,n=e.map(function(o){return o.key}),s=e.map(function(o){return o.changes}),i=[];return this._trans("readwrite",function(o){return r.getMany({trans:o,keys:n,cache:"clone"}).then(function(c){var h=[],m=[];e.forEach(function(u,x){var p=u.key,g=u.changes,b=c[x];if(b){for(var y=0,w=Object.keys(g);y<w.length;y++){var j=w[y],C=g[j];if(j===t.schema.primKey.keyPath){if(oe(C,p)!==0)throw new U.Constraint("Cannot update primary key in bulkUpdate()")}else ce(b,j,C)}i.push(x),h.push(p),m.push(b)}});var v=h.length;return r.mutate({trans:o,type:"put",keys:h,values:m,updates:{keys:n,changeSpecs:s}}).then(function(u){var x=u.numFailures,p=u.failures;if(x===0)return v;for(var g=0,b=Object.keys(p);g<b.length;g++){var y,w=b[g],j=i[Number(w)];j!=null&&(y=p[w],delete p[w],p[j]=y)}throw new Nt("".concat(t.name,".bulkUpdate(): ").concat(x," of ").concat(v," operations failed"),p)})})})},pe.prototype.bulkDelete=function(e){var t=this,r=e.length;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:e})}).then(function(o){var s=o.numFailures,i=o.lastResult,o=o.failures;if(s===0)return i;throw new Nt("".concat(t.name,".bulkDelete(): ").concat(s," of ").concat(r," operations failed"),o)})},pe);function pe(){}function Vt(e){function t(o,c){if(c){for(var h=arguments.length,m=new Array(h-1);--h;)m[h-1]=arguments[h];return r[o].subscribe.apply(null,m),e}if(typeof o=="string")return r[o]}var r={};t.addEventType=i;for(var n=1,s=arguments.length;n<s;++n)i(arguments[n]);return t;function i(o,c,h){if(typeof o!="object"){var m;c=c||ms;var v={subscribers:[],fire:h=h||fe,subscribe:function(u){v.subscribers.indexOf(u)===-1&&(v.subscribers.push(u),v.fire=c(v.fire,u))},unsubscribe:function(u){v.subscribers=v.subscribers.filter(function(x){return x!==u}),v.fire=v.subscribers.reduce(c,h)}};return r[o]=t[o]=v}E(m=o).forEach(function(u){var x=m[u];if(B(x))i(u,m[u][0],m[u][1]);else{if(x!=="asap")throw new U.InvalidArgument("Invalid event config");var p=i(u,Kt,function(){for(var g=arguments.length,b=new Array(g);g--;)b[g]=arguments[g];p.subscribers.forEach(function(y){xe(function(){y.apply(null,b)})})})}})}}function $t(e,t){return le(t).from({prototype:e}),t}function Ot(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function zr(e,t){e.filter=xt(e.filter,t)}function Ur(e,t,r){var n=e.replayFilter;e.replayFilter=n?function(){return xt(n(),t())}:t,e.justLimit=r&&!n}function ur(e,t){if(e.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(e.index);if(!r)throw new U.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function Tn(e,t,r){var n=ur(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:n,range:e.range}})}function dr(e,t,r,n){var s=e.replayFilter?xt(e.filter,e.replayFilter()):e.filter;if(e.or){var i={},o=function(c,h,m){var v,u;s&&!s(h,m,function(x){return h.stop(x)},function(x){return h.fail(x)})||((u=""+(v=h.primaryKey))=="[object ArrayBuffer]"&&(u=""+new Uint8Array(v)),Y(i,u)||(i[u]=!0,t(c,h,m)))};return Promise.all([e.or._iterate(o,r),Kn(Tn(e,n,r),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}return Kn(Tn(e,n,r),xt(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function Kn(e,t,r,n){var s=ge(n?function(i,o,c){return r(n(i),o,c)}:r);return e.then(function(i){if(i)return i.start(function(){var o=function(){return i.continue()};t&&!t(i,function(c){return o=c},function(c){i.stop(c),o=fe},function(c){i.fail(c),o=fe})||s(i.value,i,function(c){return o=c}),o()})})}var zt=(Mn.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var r=t.add;if(B(r))return k(k([],B(e)?e:[],!0),r).sort();if(typeof r=="number")return(Number(e)||0)+r;if(typeof r=="bigint")try{return BigInt(e)+r}catch{return BigInt(0)+r}throw new TypeError("Invalid term ".concat(r))}if(t.remove!==void 0){var n=t.remove;if(B(n))return B(e)?e.filter(function(s){return!n.includes(s)}).sort():[];if(typeof n=="number")return Number(e)-n;if(typeof n=="bigint")try{return BigInt(e)-n}catch{return BigInt(0)-n}throw new TypeError("Invalid subtrahend ".concat(n))}return r=(r=t.replacePrefix)===null||r===void 0?void 0:r[0],r&&typeof e=="string"&&e.startsWith(r)?t.replacePrefix[1]+e.substring(r.length):e},Mn);function Mn(e){this["@@propmod"]=e}var ws=(de.prototype._read=function(e,t){var r=this._ctx;return r.error?r.table._trans(null,je.bind(null,r.error)):r.table._trans("readonly",e).then(t)},de.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,je.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},de.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=xt(t.algorithm,e)},de.prototype._iterate=function(e,t){return dr(this._ctx,e,t,this._ctx.table.core)},de.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&q(r,e),t._ctx=r,t},de.prototype.raw=function(){return this._ctx.valueMapper=null,this},de.prototype.each=function(e){var t=this._ctx;return this._read(function(r){return dr(t,e,r,t.table.core)})},de.prototype.count=function(e){var t=this;return this._read(function(r){var n=t._ctx,s=n.table.core;if(Ot(n,!0))return s.count({trans:r,query:{index:ur(n,s.schema),range:n.range}}).then(function(o){return Math.min(o,n.limit)});var i=0;return dr(n,function(){return++i,!1},r,s).then(function(){return i})}).then(e)},de.prototype.sortBy=function(e,t){var r=e.split(".").reverse(),n=r[0],s=r.length-1;function i(h,m){return m?i(h[r[m]],m-1):h[n]}var o=this._ctx.dir==="next"?1:-1;function c(h,m){return oe(i(h,s),i(m,s))*o}return this.toArray(function(h){return h.sort(c)}).then(t)},de.prototype.toArray=function(e){var t=this;return this._read(function(r){var n=t._ctx;if(n.dir==="next"&&Ot(n,!0)&&0<n.limit){var s=n.valueMapper,i=ur(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then(function(c){return c=c.result,s?c.map(s):c})}var o=[];return dr(n,function(c){return o.push(c)},r,n.table.core).then(function(){return o})},e)},de.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Ot(t)?Ur(t,function(){var r=e;return function(n,s){return r===0||(r===1?--r:s(function(){n.advance(r),r=0}),!1)}}):Ur(t,function(){var r=e;return function(){return--r<0}})),this},de.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Ur(this._ctx,function(){var t=e;return function(r,n,s){return--t<=0&&n(s),0<=t}},!0),this},de.prototype.until=function(e,t){return zr(this._ctx,function(r,n,s){return!e(r.value)||(n(s),t)}),this},de.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},de.prototype.last=function(e){return this.reverse().first(e)},de.prototype.filter=function(e){var t;return zr(this._ctx,function(r){return e(r.value)}),(t=this._ctx).isMatch=xt(t.isMatch,e),this},de.prototype.and=function(e){return this.filter(e)},de.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},de.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},de.prototype.desc=function(){return this.reverse()},de.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,n){e(n.key,n)})},de.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},de.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,n){e(n.primaryKey,n)})},de.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each(function(n,s){r.push(s.key)}).then(function(){return r}).then(e)},de.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Ot(t,!0)&&0<t.limit)return this._read(function(n){var s=ur(t,t.table.core.schema);return t.table.core.query({trans:n,values:!1,limit:t.limit,query:{index:s,range:t.range}})}).then(function(n){return n.result}).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each(function(n,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)},de.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},de.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},de.prototype.lastKey=function(e){return this.reverse().firstKey(e)},de.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return zr(this._ctx,function(s){var n=s.primaryKey.toString(),s=Y(t,n);return t[n]=!0,!s}),this},de.prototype.modify=function(e){var t=this,r=this._ctx;return this._write(function(n){var s,i,o;o=typeof e=="function"?e:(s=E(e),i=s.length,function(y){for(var w=!1,j=0;j<i;++j){var C=s[j],N=e[C],F=we(y,C);N instanceof zt?(ce(y,C,N.execute(F)),w=!0):F!==N&&(ce(y,C,N),w=!0)}return w});var c=r.table.core,u=c.schema.primaryKey,h=u.outbound,m=u.extractKey,v=200,u=t.db._options.modifyChunkSize;u&&(v=typeof u=="object"?u[c.name]||u["*"]||200:u);function x(y,C){var j=C.failures,C=C.numFailures;g+=y-C;for(var N=0,F=E(j);N<F.length;N++){var A=F[N];p.push(j[A])}}var p=[],g=0,b=[];return t.clone().primaryKeys().then(function(y){function w(C){var N=Math.min(v,y.length-C);return c.getMany({trans:n,keys:y.slice(C,C+N),cache:"immutable"}).then(function(F){for(var A=[],D=[],P=h?[]:null,I=[],L=0;L<N;++L){var R=F[L],ee={value:T(R),primKey:y[C+L]};o.call(ee,ee.value,ee)!==!1&&(ee.value==null?I.push(y[C+L]):h||oe(m(R),m(ee.value))===0?(D.push(ee.value),h&&P.push(y[C+L])):(I.push(y[C+L]),A.push(ee.value)))}return Promise.resolve(0<A.length&&c.mutate({trans:n,type:"add",values:A}).then(function(ne){for(var se in ne.failures)I.splice(parseInt(se),1);x(A.length,ne)})).then(function(){return(0<D.length||j&&typeof e=="object")&&c.mutate({trans:n,type:"put",keys:P,values:D,criteria:j,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<C}).then(function(ne){return x(D.length,ne)})}).then(function(){return(0<I.length||j&&e===Hr)&&c.mutate({trans:n,type:"delete",keys:I,criteria:j,isAdditionalChunk:0<C}).then(function(ne){return x(I.length,ne)})}).then(function(){return y.length>C+N&&w(C+v)})})}var j=Ot(r)&&r.limit===1/0&&(typeof e!="function"||e===Hr)&&{index:r.index,range:r.range};return w(0).then(function(){if(0<p.length)throw new Zt("Error modifying one or more objects",p,g,b);return y.length})})})},de.prototype.delete=function(){var e=this._ctx,t=e.range;return Ot(e)&&(e.isPrimKey||t.type===3)?this._write(function(r){var n=e.table.core.schema.primaryKey,s=t;return e.table.core.count({trans:r,query:{index:n,range:s}}).then(function(i){return e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(function(o){var c=o.failures;if(o.lastResult,o.results,o=o.numFailures,o)throw new Zt("Could not delete some values",Object.keys(c).map(function(h){return c[h]}),i-o);return i-o})})}):this.modify(Hr)},de);function de(){}var Hr=function(e,t){return t.value=null};function ks(e,t){return e<t?-1:e===t?0:1}function js(e,t){return t<e?-1:e===t?0:1}function Ve(e,t,r){return e=e instanceof Bn?new e.Collection(e):e,e._ctx.error=new(r||TypeError)(t),e}function Pt(e){return new e.Collection(e,function(){return Rn("")}).limit(0)}function fr(e,t,r,n){var s,i,o,c,h,m,v,u=r.length;if(!r.every(function(g){return typeof g=="string"}))return Ve(e,Dn);function x(g){s=g==="next"?function(y){return y.toUpperCase()}:function(y){return y.toLowerCase()},i=g==="next"?function(y){return y.toLowerCase()}:function(y){return y.toUpperCase()},o=g==="next"?ks:js;var b=r.map(function(y){return{lower:i(y),upper:s(y)}}).sort(function(y,w){return o(y.lower,w.lower)});c=b.map(function(y){return y.upper}),h=b.map(function(y){return y.lower}),v=(m=g)==="next"?"":n}x("next"),e=new e.Collection(e,function(){return ct(c[0],h[u-1]+n)}),e._ondirectionchange=function(g){x(g)};var p=0;return e._addAlgorithm(function(g,b,y){var w=g.key;if(typeof w!="string")return!1;var j=i(w);if(t(j,h,p))return!0;for(var C=null,N=p;N<u;++N){var F=function(A,D,P,I,L,R){for(var ee=Math.min(A.length,I.length),ne=-1,se=0;se<ee;++se){var $e=D[se];if($e!==I[se])return L(A[se],P[se])<0?A.substr(0,se)+P[se]+P.substr(se+1):L(A[se],I[se])<0?A.substr(0,se)+I[se]+P.substr(se+1):0<=ne?A.substr(0,ne)+D[ne]+P.substr(ne+1):null;L(A[se],$e)<0&&(ne=se)}return ee<I.length&&R==="next"?A+P.substr(A.length):ee<A.length&&R==="prev"?A.substr(0,P.length):ne<0?null:A.substr(0,ne)+I[ne]+P.substr(ne+1)}(w,j,c[N],h[N],o,m);F===null&&C===null?p=N+1:(C===null||0<o(C,F))&&(C=F)}return b(C!==null?function(){g.continue(C+v)}:y),!1}),e}function ct(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function Rn(e){return{type:1,lower:e,upper:e}}var Bn=(Object.defineProperty(Fe.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Fe.prototype.between=function(e,t,r,n){r=r!==!1,n=n===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(r||n)&&(!r||!n)?Pt(this):new this.Collection(this,function(){return ct(e,t,!r,!n)})}catch{return Ve(this,et)}},Fe.prototype.equals=function(e){return e==null?Ve(this,et):new this.Collection(this,function(){return Rn(e)})},Fe.prototype.above=function(e){return e==null?Ve(this,et):new this.Collection(this,function(){return ct(e,void 0,!0)})},Fe.prototype.aboveOrEqual=function(e){return e==null?Ve(this,et):new this.Collection(this,function(){return ct(e,void 0,!1)})},Fe.prototype.below=function(e){return e==null?Ve(this,et):new this.Collection(this,function(){return ct(void 0,e,!1,!0)})},Fe.prototype.belowOrEqual=function(e){return e==null?Ve(this,et):new this.Collection(this,function(){return ct(void 0,e)})},Fe.prototype.startsWith=function(e){return typeof e!="string"?Ve(this,Dn):this.between(e,e+bt,!0,!0)},Fe.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):fr(this,function(t,r){return t.indexOf(r[0])===0},[e],bt)},Fe.prototype.equalsIgnoreCase=function(e){return fr(this,function(t,r){return t===r[0]},[e],"")},Fe.prototype.anyOfIgnoreCase=function(){var e=Je.apply(Ie,arguments);return e.length===0?Pt(this):fr(this,function(t,r){return r.indexOf(t)!==-1},e,"")},Fe.prototype.startsWithAnyOfIgnoreCase=function(){var e=Je.apply(Ie,arguments);return e.length===0?Pt(this):fr(this,function(t,r){return r.some(function(n){return t.indexOf(n)===0})},e,bt)},Fe.prototype.anyOf=function(){var e=this,t=Je.apply(Ie,arguments),r=this._cmp;try{t.sort(r)}catch{return Ve(this,et)}if(t.length===0)return Pt(this);var n=new this.Collection(this,function(){return ct(t[0],t[t.length-1])});n._ondirectionchange=function(i){r=i==="next"?e._ascending:e._descending,t.sort(r)};var s=0;return n._addAlgorithm(function(i,o,c){for(var h=i.key;0<r(h,t[s]);)if(++s===t.length)return o(c),!1;return r(h,t[s])===0||(o(function(){i.continue(t[s])}),!1)}),n},Fe.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Fe.prototype.noneOf=function(){var e=Je.apply(Ie,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Ve(this,et)}var t=e.reduce(function(r,n){return r?r.concat([[r[r.length-1][1],n]]):[[-1/0,n]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Fe.prototype.inAnyRange=function(w,t){var r=this,n=this._cmp,s=this._ascending,i=this._descending,o=this._min,c=this._max;if(w.length===0)return Pt(this);if(!w.every(function(j){return j[0]!==void 0&&j[1]!==void 0&&s(j[0],j[1])<=0}))return Ve(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",U.InvalidArgument);var h=!t||t.includeLowers!==!1,m=t&&t.includeUppers===!0,v,u=s;function x(j,C){return u(j[0],C[0])}try{(v=w.reduce(function(j,C){for(var N=0,F=j.length;N<F;++N){var A=j[N];if(n(C[0],A[1])<0&&0<n(C[1],A[0])){A[0]=o(A[0],C[0]),A[1]=c(A[1],C[1]);break}}return N===F&&j.push(C),j},[])).sort(x)}catch{return Ve(this,et)}var p=0,g=m?function(j){return 0<s(j,v[p][1])}:function(j){return 0<=s(j,v[p][1])},b=h?function(j){return 0<i(j,v[p][0])}:function(j){return 0<=i(j,v[p][0])},y=g,w=new this.Collection(this,function(){return ct(v[0][0],v[v.length-1][1],!h,!m)});return w._ondirectionchange=function(j){u=j==="next"?(y=g,s):(y=b,i),v.sort(x)},w._addAlgorithm(function(j,C,N){for(var F,A=j.key;y(A);)if(++p===v.length)return C(N),!1;return!g(F=A)&&!b(F)||(r._cmp(A,v[p][1])===0||r._cmp(A,v[p][0])===0||C(function(){u===s?j.continue(v[p][0]):j.continue(v[p][1])}),!1)}),w},Fe.prototype.startsWithAnyOf=function(){var e=Je.apply(Ie,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Pt(this):this.inAnyRange(e.map(function(t){return[t,t+bt]})):Ve(this,"startsWithAnyOf() only works with strings")},Fe);function Fe(){}function Ge(e){return ge(function(t){return Ut(t),e(t.target.error),!1})}function Ut(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Ht="storagemutated",Wr="x-storagemutated-1",ut=Vt(null,Ht),_s=(Qe.prototype._lock=function(){return ye(!$.global),++this._reculock,this._reculock!==1||$.global||($.lockOwnerFor=this),this},Qe.prototype._unlock=function(){if(ye(!$.global),--this._reculock==0)for($.global||($.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{vt(e[1],e[0])}catch{}}return this},Qe.prototype._locked=function(){return this._reculock&&$.lockOwnerFor!==this},Qe.prototype.create=function(e){var t=this;if(!this.mode)return this;var r=this.db.idbdb,n=this.db._state.dbOpenError;if(ye(!this.idbtrans),!e&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new U.DatabaseClosed(n);case"MissingAPIError":throw new U.MissingAPI(n.message,n);default:throw new U.OpenFailed(n)}if(!this.active)throw new U.TransactionInactive;return ye(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||r).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ge(function(s){Ut(s),t._reject(e.error)}),e.onabort=ge(function(s){Ut(s),t.active&&t._reject(new U.Abort(e.error)),t.active=!1,t.on("abort").fire(s)}),e.oncomplete=ge(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&ut.storagemutated.fire(e.mutatedParts)}),this},Qe.prototype._promise=function(e,t,r){var n=this;if(e==="readwrite"&&this.mode!=="readwrite")return je(new U.ReadOnly("Transaction is readonly"));if(!this.active)return je(new U.TransactionInactive);if(this._locked())return new K(function(i,o){n._blockedFuncs.push([function(){n._promise(e,t,r).then(i,o)},$])});if(r)return at(function(){var i=new K(function(o,c){n._lock();var h=t(o,c,n);h&&h.then&&h.then(o,c)});return i.finally(function(){return n._unlock()}),i._lib=!0,i});var s=new K(function(i,o){var c=t(i,o,n);c&&c.then&&c.then(i,o)});return s._lib=!0,s},Qe.prototype._root=function(){return this.parent?this.parent._root():this},Qe.prototype.waitFor=function(e){var t,r=this._root(),n=K.resolve(e);r._waitingFor?r._waitingFor=r._waitingFor.then(function(){return n}):(r._waitingFor=n,r._waitingQueue=[],t=r.idbtrans.objectStore(r.storeNames[0]),function i(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(t.get(-1/0).onsuccess=i)}());var s=r._waitingFor;return new K(function(i,o){n.then(function(c){return r._waitingQueue.push(ge(i.bind(null,c)))},function(c){return r._waitingQueue.push(ge(o.bind(null,c)))}).finally(function(){r._waitingFor===s&&(r._waitingFor=null)})})},Qe.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new U.Abort))},Qe.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(Y(t,e))return t[e];var r=this.schema[e];if(!r)throw new U.NotFound("Table "+e+" not part of transaction");return r=new this.db.Table(e,r,this),r.core=this.db.core.table(e),t[e]=r},Qe);function Qe(){}function Yr(e,t,r,n,s,i,o){return{name:e,keyPath:t,unique:r,multi:n,auto:s,compound:i,src:(r&&!o?"&":"")+(n?"*":"")+(s?"++":"")+qn(t)}}function qn(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Xr(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:(n=function(s){return[s.name,s]},r.reduce(function(s,i,o){return o=n(i,o),o&&(s[o[0]]=o[1]),s},{}))};var n}var Wt=function(e){try{return e.only([[]]),Wt=function(){return[[]]},[[]]}catch{return Wt=function(){return bt},bt}};function Gr(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(r){return r[t]}:function(r){return we(r,t)}:function(r){return we(r,e)};var t}function Vn(e){return[].slice.call(e)}var Cs=0;function Yt(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Ns(e,t,h){function n(y){if(y.type===3)return null;if(y.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var p=y.lower,g=y.upper,b=y.lowerOpen,y=y.upperOpen;return p===void 0?g===void 0?null:t.upperBound(g,!!y):g===void 0?t.lowerBound(p,!!b):t.bound(p,g,!!b,!!y)}function s(x){var p,g=x.name;return{name:g,schema:x,mutate:function(b){var y=b.trans,w=b.type,j=b.keys,C=b.values,N=b.range;return new Promise(function(F,A){F=ge(F);var D=y.objectStore(g),P=D.keyPath==null,I=w==="put"||w==="add";if(!I&&w!=="delete"&&w!=="deleteRange")throw new Error("Invalid operation type: "+w);var L,R=(j||C||{length:1}).length;if(j&&C&&j.length!==C.length)throw new Error("Given keys array must have same length as given values array.");if(R===0)return F({numFailures:0,failures:{},results:[],lastResult:void 0});function ee(Te){++$e,Ut(Te)}var ne=[],se=[],$e=0;if(w==="deleteRange"){if(N.type===4)return F({numFailures:$e,failures:se,results:[],lastResult:void 0});N.type===3?ne.push(L=D.clear()):ne.push(L=D.delete(n(N)))}else{var P=I?P?[C,j]:[C,null]:[j,null],Z=P[0],Pe=P[1];if(I)for(var Le=0;Le<R;++Le)ne.push(L=Pe&&Pe[Le]!==void 0?D[w](Z[Le],Pe[Le]):D[w](Z[Le])),L.onerror=ee;else for(Le=0;Le<R;++Le)ne.push(L=D[w](Z[Le])),L.onerror=ee}function Cr(Te){Te=Te.target.result,ne.forEach(function(jt,mn){return jt.error!=null&&(se[mn]=jt.error)}),F({numFailures:$e,failures:se,results:w==="delete"?j:ne.map(function(jt){return jt.result}),lastResult:Te})}L.onerror=function(Te){ee(Te),Cr(Te)},L.onsuccess=Cr})},getMany:function(b){var y=b.trans,w=b.keys;return new Promise(function(j,C){j=ge(j);for(var N,F=y.objectStore(g),A=w.length,D=new Array(A),P=0,I=0,L=function(ne){ne=ne.target,D[ne._pos]=ne.result,++I===P&&j(D)},R=Ge(C),ee=0;ee<A;++ee)w[ee]!=null&&((N=F.get(w[ee]))._pos=ee,N.onsuccess=L,N.onerror=R,++P);P===0&&j(D)})},get:function(b){var y=b.trans,w=b.key;return new Promise(function(j,C){j=ge(j);var N=y.objectStore(g).get(w);N.onsuccess=function(F){return j(F.target.result)},N.onerror=Ge(C)})},query:(p=m,function(b){return new Promise(function(y,w){y=ge(y);var j,C,N,P=b.trans,F=b.values,A=b.limit,L=b.query,D=A===1/0?void 0:A,I=L.index,L=L.range,P=P.objectStore(g),I=I.isPrimaryKey?P:P.index(I.name),L=n(L);if(A===0)return y({result:[]});p?((D=F?I.getAll(L,D):I.getAllKeys(L,D)).onsuccess=function(R){return y({result:R.target.result})},D.onerror=Ge(w)):(j=0,C=!F&&"openKeyCursor"in I?I.openKeyCursor(L):I.openCursor(L),N=[],C.onsuccess=function(R){var ee=C.result;return ee?(N.push(F?ee.value:ee.primaryKey),++j===A?y({result:N}):void ee.continue()):y({result:N})},C.onerror=Ge(w))})}),openCursor:function(b){var y=b.trans,w=b.values,j=b.query,C=b.reverse,N=b.unique;return new Promise(function(F,A){F=ge(F);var I=j.index,D=j.range,P=y.objectStore(g),P=I.isPrimaryKey?P:P.index(I.name),I=C?N?"prevunique":"prev":N?"nextunique":"next",L=!w&&"openKeyCursor"in P?P.openKeyCursor(n(D),I):P.openCursor(n(D),I);L.onerror=Ge(A),L.onsuccess=ge(function(R){var ee,ne,se,$e,Z=L.result;Z?(Z.___id=++Cs,Z.done=!1,ee=Z.continue.bind(Z),ne=(ne=Z.continuePrimaryKey)&&ne.bind(Z),se=Z.advance.bind(Z),$e=function(){throw new Error("Cursor not stopped")},Z.trans=y,Z.stop=Z.continue=Z.continuePrimaryKey=Z.advance=function(){throw new Error("Cursor not started")},Z.fail=ge(A),Z.next=function(){var Pe=this,Le=1;return this.start(function(){return Le--?Pe.continue():Pe.stop()}).then(function(){return Pe})},Z.start=function(Pe){function Le(){if(L.result)try{Pe()}catch(Te){Z.fail(Te)}else Z.done=!0,Z.start=function(){throw new Error("Cursor behind last entry")},Z.stop()}var Cr=new Promise(function(Te,jt){Te=ge(Te),L.onerror=Ge(jt),Z.fail=jt,Z.stop=function(mn){Z.stop=Z.continue=Z.continuePrimaryKey=Z.advance=$e,Te(mn)}});return L.onsuccess=ge(function(Te){L.onsuccess=Le,Le()}),Z.continue=ee,Z.continuePrimaryKey=ne,Z.advance=se,Le(),Cr},F(Z)):F(null)},A)})},count:function(b){var y=b.query,w=b.trans,j=y.index,C=y.range;return new Promise(function(N,F){var A=w.objectStore(g),D=j.isPrimaryKey?A:A.index(j.name),A=n(C),D=A?D.count(A):D.count();D.onsuccess=ge(function(P){return N(P.target.result)}),D.onerror=Ge(F)})}}}var i,o,c,v=(o=h,c=Vn((i=e).objectStoreNames),{schema:{name:i.name,tables:c.map(function(x){return o.objectStore(x)}).map(function(x){var p=x.keyPath,y=x.autoIncrement,g=B(p),b={},y={name:x.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:p==null,compound:g,keyPath:p,autoIncrement:y,unique:!0,extractKey:Gr(p)},indexes:Vn(x.indexNames).map(function(w){return x.index(w)}).map(function(N){var j=N.name,C=N.unique,F=N.multiEntry,N=N.keyPath,F={name:j,compound:B(N),keyPath:N,unique:C,multiEntry:F,extractKey:Gr(N)};return b[Yt(N)]=F}),getIndexByKeyPath:function(w){return b[Yt(w)]}};return b[":id"]=y.primaryKey,p!=null&&(b[Yt(p)]=y.primaryKey),y})},hasGetAll:0<c.length&&"getAll"in o.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),h=v.schema,m=v.hasGetAll,v=h.tables.map(s),u={};return v.forEach(function(x){return u[x.name]=x}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(x){if(!u[x])throw new Error("Table '".concat(x,"' not found"));return u[x]},MIN_KEY:-1/0,MAX_KEY:Wt(t),schema:h}}function Ss(e,t,r,n){var s=r.IDBKeyRange;return r.indexedDB,{dbcore:(n=Ns(t,s,n),e.dbcore.reduce(function(i,o){return o=o.create,d(d({},i),o(i))},n))}}function hr(e,n){var r=n.db,n=Ss(e._middlewares,r,e._deps,n);e.core=n.dbcore,e.tables.forEach(function(s){var i=s.name;e.core.schema.tables.some(function(o){return o.name===i})&&(s.core=e.core.table(i),e[i]instanceof e.Table&&(e[i].core=s.core))})}function pr(e,t,r,n){r.forEach(function(s){var i=n[s];t.forEach(function(o){var c=function h(m,v){return me(m,v)||(m=V(m))&&h(m,v)}(o,s);(!c||"value"in c&&c.value===void 0)&&(o===e.Transaction.prototype||o instanceof e.Transaction?te(o,s,{get:function(){return this.table(s)},set:function(h){J(this,s,{value:h,writable:!0,configurable:!0,enumerable:!0})}}):o[s]=new e.Table(s,i))})})}function Qr(e,t){t.forEach(function(r){for(var n in r)r[n]instanceof e.Table&&delete r[n]})}function Es(e,t){return e._cfg.version-t._cfg.version}function Fs(e,t,r,n){var s=e._dbSchema;r.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=Xr("$meta",zn("")[0],[]),e._storeNames.push("$meta"));var i=e._createTransaction("readwrite",e._storeNames,s);i.create(r),i._completion.catch(n);var o=i._reject.bind(i),c=$.transless||$;at(function(){return $.trans=i,$.transless=c,t!==0?(hr(e,r),m=t,((h=i).storeNames.includes("$meta")?h.table("$meta").get("version").then(function(v){return v??m}):K.resolve(m)).then(function(v){return x=v,p=i,g=r,b=[],v=(u=e)._versions,y=u._dbSchema=yr(0,u.idbdb,g),(v=v.filter(function(w){return w._cfg.version>=x})).length!==0?(v.forEach(function(w){b.push(function(){var j=y,C=w._cfg.dbschema;gr(u,j,g),gr(u,C,g),y=u._dbSchema=C;var N=Zr(j,C);N.add.forEach(function(I){Jr(g,I[0],I[1].primKey,I[1].indexes)}),N.change.forEach(function(I){if(I.recreate)throw new U.Upgrade("Not yet support for changing primary key");var L=g.objectStore(I.name);I.add.forEach(function(R){return mr(L,R)}),I.change.forEach(function(R){L.deleteIndex(R.name),mr(L,R)}),I.del.forEach(function(R){return L.deleteIndex(R)})});var F=w._cfg.contentUpgrade;if(F&&w._cfg.version>x){hr(u,g),p._memoizedTables={};var A=Ne(C);N.del.forEach(function(I){A[I]=j[I]}),Qr(u,[u.Transaction.prototype]),pr(u,[u.Transaction.prototype],E(A),A),p.schema=A;var D,P=Or(F);return P&&Ft(),N=K.follow(function(){var I;(D=F(p))&&P&&(I=ot.bind(null,null),D.then(I,I))}),D&&typeof D.then=="function"?K.resolve(D):N.then(function(){return D})}}),b.push(function(j){var C,N,F=w._cfg.dbschema;C=F,N=j,[].slice.call(N.db.objectStoreNames).forEach(function(A){return C[A]==null&&N.db.deleteObjectStore(A)}),Qr(u,[u.Transaction.prototype]),pr(u,[u.Transaction.prototype],u._storeNames,u._dbSchema),p.schema=u._dbSchema}),b.push(function(j){u.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(u.idbdb.version/10)===w._cfg.version?(u.idbdb.deleteObjectStore("$meta"),delete u._dbSchema.$meta,u._storeNames=u._storeNames.filter(function(C){return C!=="$meta"})):j.objectStore("$meta").put(w._cfg.version,"version"))})}),function w(){return b.length?K.resolve(b.shift()(p.idbtrans)).then(w):K.resolve()}().then(function(){$n(y,g)})):K.resolve();var u,x,p,g,b,y}).catch(o)):(E(s).forEach(function(v){Jr(r,v,s[v].primKey,s[v].indexes)}),hr(e,r),void K.follow(function(){return e.on.populate.fire(i)}).catch(o));var h,m})}function Ds(e,t){$n(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var r=yr(0,e.idbdb,t);gr(e,e._dbSchema,t);for(var n=0,s=Zr(r,e._dbSchema).change;n<s.length;n++){var i=function(o){if(o.change.length||o.recreate)return console.warn("Unable to patch indexes of table ".concat(o.name," because it has changes on the type of index or primary key.")),{value:void 0};var c=t.objectStore(o.name);o.add.forEach(function(h){Xe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(o.name,".").concat(h.src)),mr(c,h)})}(s[n]);if(typeof i=="object")return i.value}}function Zr(e,t){var r,n={del:[],add:[],change:[]};for(r in e)t[r]||n.del.push(r);for(r in t){var s=e[r],i=t[r];if(s){var o={name:r,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||s.primKey.auto!==i.primKey.auto)o.recreate=!0,n.change.push(o);else{var c=s.idxByName,h=i.idxByName,m=void 0;for(m in c)h[m]||o.del.push(m);for(m in h){var v=c[m],u=h[m];v?v.src!==u.src&&o.change.push(u):o.add.push(u)}(0<o.del.length||0<o.add.length||0<o.change.length)&&n.change.push(o)}}else n.add.push([r,i])}return n}function Jr(e,t,r,n){var s=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(function(i){return mr(s,i)}),s}function $n(e,t){E(e).forEach(function(r){t.db.objectStoreNames.contains(r)||(Xe&&console.debug("Dexie: Creating missing table",r),Jr(t,r,e[r].primKey,e[r].indexes))})}function mr(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function yr(e,t,r){var n={};return be(t.objectStoreNames,0).forEach(function(s){for(var i=r.objectStore(s),o=Yr(qn(m=i.keyPath),m||"",!0,!1,!!i.autoIncrement,m&&typeof m!="string",!0),c=[],h=0;h<i.indexNames.length;++h){var v=i.index(i.indexNames[h]),m=v.keyPath,v=Yr(v.name,m,!!v.unique,!!v.multiEntry,!1,m&&typeof m!="string",!1);c.push(v)}n[s]=Xr(s,o,c)}),n}function gr(e,t,r){for(var n=r.db.objectStoreNames,s=0;s<n.length;++s){var i=n[s],o=r.objectStore(i);e._hasGetAll="getAll"in o;for(var c=0;c<o.indexNames.length;++c){var h=o.indexNames[c],m=o.index(h).keyPath,v=typeof m=="string"?m:"["+be(m).join("+")+"]";!t[i]||(m=t[i].idxByName[v])&&(m.name=h,delete t[i].idxByName[v],t[i].idxByName[h]=m)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&S.WorkerGlobalScope&&S instanceof S.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function zn(e){return e.split(",").map(function(t,r){var n=(t=t.trim()).replace(/([&*]|\+\+)/g,""),s=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Yr(n,s||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),B(s),r===0)})}var Os=(vr.prototype._parseStoresSpec=function(e,t){E(e).forEach(function(r){if(e[r]!==null){var n=zn(e[r]),s=n.shift();if(s.unique=!0,s.multi)throw new U.Schema("Primary key cannot be multi-valued");n.forEach(function(i){if(i.auto)throw new U.Schema("Only primary key can be marked as autoIncrement (++)");if(!i.keyPath)throw new U.Schema("Index must have a name and cannot be an empty string")}),t[r]=Xr(r,s,n)}})},vr.prototype.stores=function(r){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?q(this._cfg.storesSource,r):r;var r=t._versions,n={},s={};return r.forEach(function(i){q(n,i._cfg.storesSource),s=i._cfg.dbschema={},i._parseStoresSpec(n,s)}),t._dbSchema=s,Qr(t,[t._allTables,t,t.Transaction.prototype]),pr(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],E(s),s),t._storeNames=E(s),this},vr.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Lr(this._cfg.contentUpgrade||fe,e),this},vr);function vr(){}function en(e,t){var r=e._dbNamesDB;return r||(r=e._dbNamesDB=new tt(lr,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),r.table("dbnames")}function tn(e){return e&&typeof e.databases=="function"}function rn(e){return at(function(){return $.letThrough=!0,e()})}function nn(e){return!("from"in e)}var Oe=function(e,t){if(!this){var r=new Oe;return e&&"d"in e&&q(r,e),r}q(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function Xt(e,t,r){var n=oe(t,r);if(!isNaN(n)){if(0<n)throw RangeError();if(nn(e))return q(e,{from:t,to:r,d:1});var s=e.l,n=e.r;if(oe(r,e.from)<0)return s?Xt(s,t,r):e.l={from:t,to:r,d:1,l:null,r:null},Hn(e);if(0<oe(t,e.to))return n?Xt(n,t,r):e.r={from:t,to:r,d:1,l:null,r:null},Hn(e);oe(t,e.from)<0&&(e.from=t,e.l=null,e.d=n?n.d+1:1),0<oe(r,e.to)&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1),r=!e.r,s&&!e.l&&Gt(e,s),n&&r&&Gt(e,n)}}function Gt(e,t){nn(t)||function r(n,h){var i=h.from,o=h.to,c=h.l,h=h.r;Xt(n,i,o),c&&r(n,c),h&&r(n,h)}(e,t)}function Un(e,t){var r=br(t),n=r.next();if(n.done)return!1;for(var s=n.value,i=br(e),o=i.next(s.from),c=o.value;!n.done&&!o.done;){if(oe(c.from,s.to)<=0&&0<=oe(c.to,s.from))return!0;oe(s.from,c.from)<0?s=(n=r.next(c.from)).value:c=(o=i.next(s.from)).value}return!1}function br(e){var t=nn(e)?null:{s:0,n:e};return{next:function(r){for(var n=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&oe(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||oe(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Hn(e){var t,r,n=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),s=1<n?"r":n<-1?"l":"";s&&(t=s=="r"?"l":"r",r=d({},e),n=e[s],e.from=n.from,e.to=n.to,e[s]=n[s],r[s]=n[t],(e[t]=r).d=Wn(r)),e.d=Wn(e)}function Wn(r){var t=r.r,r=r.l;return(t?r?Math.max(t.d,r.d):t.d:r?r.d:0)+1}function xr(e,t){return E(t).forEach(function(r){e[r]?Gt(e[r],t[r]):e[r]=function n(s){var i,o,c={};for(i in s)Y(s,i)&&(o=s[i],c[i]=!o||typeof o!="object"||ae.has(o.constructor)?o:n(o));return c}(t[r])}),e}function sn(e,t){return e.all||t.all||Object.keys(e).some(function(r){return t[r]&&Un(t[r],e[r])})}M(Oe.prototype,((Ue={add:function(e){return Gt(this,e),this},addKey:function(e){return Xt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(r){return Xt(t,r,r)}),this},hasKey:function(e){var t=br(this).next(e).value;return t&&oe(t.from,e)<=0&&0<=oe(t.to,e)}})[Q]=function(){return br(this)},Ue));var wt={},an={},on=!1;function wr(e){xr(an,e),on||(on=!0,setTimeout(function(){on=!1,ln(an,!(an={}))},0))}function ln(e,t){t===void 0&&(t=!1);var r=new Set;if(e.all)for(var n=0,s=Object.values(wt);n<s.length;n++)Yn(o=s[n],e,r,t);else for(var i in e){var o,c=/^idb\:\/\/(.*)\/(.*)\//.exec(i);c&&(i=c[1],c=c[2],(o=wt["idb://".concat(i,"/").concat(c)])&&Yn(o,e,r,t))}r.forEach(function(h){return h()})}function Yn(e,t,r,n){for(var s=[],i=0,o=Object.entries(e.queries.query);i<o.length;i++){for(var c=o[i],h=c[0],m=[],v=0,u=c[1];v<u.length;v++){var x=u[v];sn(t,x.obsSet)?x.subscribers.forEach(function(y){return r.add(y)}):n&&m.push(x)}n&&s.push([h,m])}if(n)for(var p=0,g=s;p<g.length;p++){var b=g[p],h=b[0],m=b[1];e.queries.query[h]=m}}function Ps(e){var t=e._state,r=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?je(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var n=t.openCanceller,s=Math.round(10*e.verno),i=!1;function o(){if(t.openCanceller!==n)throw new U.DatabaseClosed("db.open() was cancelled")}function c(){return new K(function(x,p){if(o(),!r)throw new U.MissingAPI;var g=e.name,b=t.autoSchema||!s?r.open(g):r.open(g,s);if(!b)throw new U.MissingAPI;b.onerror=Ge(p),b.onblocked=ge(e._fireOnBlocked),b.onupgradeneeded=ge(function(y){var w;v=b.transaction,t.autoSchema&&!e._options.allowEmptyDB?(b.onerror=Ut,v.abort(),b.result.close(),(w=r.deleteDatabase(g)).onsuccess=w.onerror=ge(function(){p(new U.NoSuchDatabase("Database ".concat(g," doesnt exist")))})):(v.onerror=Ge(p),y=y.oldVersion>Math.pow(2,62)?0:y.oldVersion,u=y<1,e.idbdb=b.result,i&&Ds(e,v),Fs(e,y/10,v,p))},p),b.onsuccess=ge(function(){v=null;var y,w,j,C,N,F=e.idbdb=b.result,A=be(F.objectStoreNames);if(0<A.length)try{var D=F.transaction((C=A).length===1?C[0]:C,"readonly");if(t.autoSchema)w=F,j=D,(y=e).verno=w.version/10,j=y._dbSchema=yr(0,w,j),y._storeNames=be(w.objectStoreNames,0),pr(y,[y._allTables],E(j),j);else if(gr(e,e._dbSchema,D),((N=Zr(yr(0,(N=e).idbdb,D),N._dbSchema)).add.length||N.change.some(function(P){return P.add.length||P.change.length}))&&!i)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),F.close(),s=F.version+1,i=!0,x(c());hr(e,D)}catch{}Dt.push(e),F.onversionchange=ge(function(P){t.vcFired=!0,e.on("versionchange").fire(P)}),F.onclose=ge(function(P){e.on("close").fire(P)}),u&&(N=e._deps,D=g,F=N.indexedDB,N=N.IDBKeyRange,tn(F)||D===lr||en(F,N).put({name:D}).catch(fe)),x()},p)}).catch(function(x){switch(x?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),c();break;case"VersionError":if(0<s)return s=0,c()}return K.reject(x)})}var h,m=t.dbReadyResolve,v=null,u=!1;return K.race([n,(typeof navigator>"u"?K.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(x){function p(){return indexedDB.databases().finally(x)}h=setInterval(p,100),p()}).finally(function(){return clearInterval(h)}):Promise.resolve()).then(c)]).then(function(){return o(),t.onReadyBeingFired=[],K.resolve(rn(function(){return e.on.ready.fire(e.vip)})).then(function x(){if(0<t.onReadyBeingFired.length){var p=t.onReadyBeingFired.reduce(Lr,fe);return t.onReadyBeingFired=[],K.resolve(rn(function(){return p(e.vip)})).then(x)}})}).finally(function(){t.openCanceller===n&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(x){t.dbOpenError=x;try{v&&v.abort()}catch{}return n===t.openCanceller&&e._close(),je(x)}).finally(function(){t.openComplete=!0,m()}).then(function(){var x;return u&&(x={},e.tables.forEach(function(p){p.schema.indexes.forEach(function(g){g.name&&(x["idb://".concat(e.name,"/").concat(p.name,"/").concat(g.name)]=new Oe(-1/0,[[[]]]))}),x["idb://".concat(e.name,"/").concat(p.name,"/")]=x["idb://".concat(e.name,"/").concat(p.name,"/:dels")]=new Oe(-1/0,[[[]]])}),ut(Ht).fire(x),ln(x,!0)),e})}function cn(e){function t(i){return e.next(i)}var r=s(t),n=s(function(i){return e.throw(i)});function s(i){return function(h){var c=i(h),h=c.value;return c.done?h:h&&typeof h.then=="function"?h.then(r,n):B(h)?Promise.all(h).then(r,n):r(h)}}return s(t)()}function kr(e,t,r){for(var n=B(e)?e.slice():[e],s=0;s<r;++s)n.push(t);return n}var Ls={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return d(d({},e),{table:function(t){var r=e.table(t),n=r.schema,s={},i=[];function o(u,x,p){var g=Yt(u),b=s[g]=s[g]||[],y=u==null?0:typeof u=="string"?1:u.length,w=0<x,w=d(d({},p),{name:w?"".concat(g,"(virtual-from:").concat(p.name,")"):p.name,lowLevelIndex:p,isVirtual:w,keyTail:x,keyLength:y,extractKey:Gr(u),unique:!w&&p.unique});return b.push(w),w.isPrimaryKey||i.push(w),1<y&&o(y===2?u[0]:u.slice(0,y-1),x+1,p),b.sort(function(j,C){return j.keyTail-C.keyTail}),w}t=o(n.primaryKey.keyPath,0,n.primaryKey),s[":id"]=[t];for(var c=0,h=n.indexes;c<h.length;c++){var m=h[c];o(m.keyPath,0,m)}function v(u){var x,p=u.query.index;return p.isVirtual?d(d({},u),{query:{index:p.lowLevelIndex,range:(x=u.query.range,p=p.keyTail,{type:x.type===1?2:x.type,lower:kr(x.lower,x.lowerOpen?e.MAX_KEY:e.MIN_KEY,p),lowerOpen:!0,upper:kr(x.upper,x.upperOpen?e.MIN_KEY:e.MAX_KEY,p),upperOpen:!0})}}):u}return d(d({},r),{schema:d(d({},n),{primaryKey:t,indexes:i,getIndexByKeyPath:function(u){return(u=s[Yt(u)])&&u[0]}}),count:function(u){return r.count(v(u))},query:function(u){return r.query(v(u))},openCursor:function(u){var x=u.query.index,p=x.keyTail,g=x.isVirtual,b=x.keyLength;return g?r.openCursor(v(u)).then(function(w){return w&&y(w)}):r.openCursor(u);function y(w){return Object.create(w,{continue:{value:function(j){j!=null?w.continue(kr(j,u.reverse?e.MAX_KEY:e.MIN_KEY,p)):u.unique?w.continue(w.key.slice(0,b).concat(u.reverse?e.MIN_KEY:e.MAX_KEY,p)):w.continue()}},continuePrimaryKey:{value:function(j,C){w.continuePrimaryKey(kr(j,e.MAX_KEY,p),C)}},primaryKey:{get:function(){return w.primaryKey}},key:{get:function(){var j=w.key;return b===1?j[0]:j.slice(0,b)}},value:{get:function(){return w.value}}})}}})}})}};function un(e,t,r,n){return r=r||{},n=n||"",E(e).forEach(function(s){var i,o,c;Y(t,s)?(i=e[s],o=t[s],typeof i=="object"&&typeof o=="object"&&i&&o?(c=X(i))!==X(o)?r[n+s]=t[s]:c==="Object"?un(i,o,r,n+s+"."):i!==o&&(r[n+s]=t[s]):i!==o&&(r[n+s]=t[s])):r[n+s]=void 0}),E(t).forEach(function(s){Y(e,s)||(r[n+s]=t[s])}),r}function dn(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var As={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return d(d({},e),{table:function(t){var r=e.table(t),n=r.schema.primaryKey;return d(d({},r),{mutate:function(s){var i=$.trans,o=i.table(t).hook,c=o.deleting,h=o.creating,m=o.updating;switch(s.type){case"add":if(h.fire===fe)break;return i._promise("readwrite",function(){return v(s)},!0);case"put":if(h.fire===fe&&m.fire===fe)break;return i._promise("readwrite",function(){return v(s)},!0);case"delete":if(c.fire===fe)break;return i._promise("readwrite",function(){return v(s)},!0);case"deleteRange":if(c.fire===fe)break;return i._promise("readwrite",function(){return function u(x,p,g){return r.query({trans:x,values:!1,query:{index:n,range:p},limit:g}).then(function(b){var y=b.result;return v({type:"delete",keys:y,trans:x}).then(function(w){return 0<w.numFailures?Promise.reject(w.failures[0]):y.length<g?{failures:[],numFailures:0,lastResult:void 0}:u(x,d(d({},p),{lower:y[y.length-1],lowerOpen:!0}),g)})})}(s.trans,s.range,1e4)},!0)}return r.mutate(s);function v(u){var x,p,g,b=$.trans,y=u.keys||dn(n,u);if(!y)throw new Error("Keys missing");return(u=u.type==="add"||u.type==="put"?d(d({},u),{keys:y}):d({},u)).type!=="delete"&&(u.values=k([],u.values)),u.keys&&(u.keys=k([],u.keys)),x=r,g=y,((p=u).type==="add"?Promise.resolve([]):x.getMany({trans:p.trans,keys:g,cache:"immutable"})).then(function(w){var j=y.map(function(C,N){var F,A,D,P=w[N],I={onerror:null,onsuccess:null};return u.type==="delete"?c.fire.call(I,C,P,b):u.type==="add"||P===void 0?(F=h.fire.call(I,C,u.values[N],b),C==null&&F!=null&&(u.keys[N]=C=F,n.outbound||ce(u.values[N],n.keyPath,C))):(F=un(P,u.values[N]),(A=m.fire.call(I,F,C,P,b))&&(D=u.values[N],Object.keys(A).forEach(function(L){Y(D,L)?D[L]=A[L]:ce(D,L,A[L])}))),I});return r.mutate(u).then(function(C){for(var N=C.failures,F=C.results,A=C.numFailures,C=C.lastResult,D=0;D<y.length;++D){var P=(F||y)[D],I=j[D];P==null?I.onerror&&I.onerror(N[D]):I.onsuccess&&I.onsuccess(u.type==="put"&&w[D]?u.values[D]:P)}return{failures:N,results:F,numFailures:A,lastResult:C}}).catch(function(C){return j.forEach(function(N){return N.onerror&&N.onerror(C)}),Promise.reject(C)})})}}})}})}};function Xn(e,t,r){try{if(!t||t.keys.length<e.length)return null;for(var n=[],s=0,i=0;s<t.keys.length&&i<e.length;++s)oe(t.keys[s],e[i])===0&&(n.push(r?T(t.values[s]):t.values[s]),++i);return n.length===e.length?n:null}catch{return null}}var Is={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return d(d({},r),{getMany:function(n){if(!n.cache)return r.getMany(n);var s=Xn(n.keys,n.trans._cache,n.cache==="clone");return s?K.resolve(s):r.getMany(n).then(function(i){return n.trans._cache={keys:n.keys,values:n.cache==="clone"?T(i):i},i})},mutate:function(n){return n.type!=="add"&&(n.trans._cache=null),r.mutate(n)}})}}}};function Gn(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Qn(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Ts={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new Oe(e.MIN_KEY,e.MAX_KEY);return d(d({},e),{transaction:function(n,s,i){if($.subscr&&s!=="readonly")throw new U.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat($.querier));return e.transaction(n,s,i)},table:function(n){var s=e.table(n),i=s.schema,o=i.primaryKey,u=i.indexes,c=o.extractKey,h=o.outbound,m=o.autoIncrement&&u.filter(function(p){return p.compound&&p.keyPath.includes(o.keyPath)}),v=d(d({},s),{mutate:function(p){function g(L){return L="idb://".concat(t,"/").concat(n,"/").concat(L),C[L]||(C[L]=new Oe)}var b,y,w,j=p.trans,C=p.mutatedParts||(p.mutatedParts={}),N=g(""),F=g(":dels"),A=p.type,I=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[dn(o,p).filter(function(L){return L}),p.values]:[],D=I[0],P=I[1],I=p.trans._cache;return B(D)?(N.addKeys(D),(I=A==="delete"||D.length===P.length?Xn(D,I):null)||F.addKeys(D),(I||P)&&(b=g,y=I,w=P,i.indexes.forEach(function(L){var R=b(L.name||"");function ee(se){return se!=null?L.extractKey(se):null}function ne(se){return L.multiEntry&&B(se)?se.forEach(function($e){return R.addKey($e)}):R.addKey(se)}(y||w).forEach(function(se,Pe){var Z=y&&ee(y[Pe]),Pe=w&&ee(w[Pe]);oe(Z,Pe)!==0&&(Z!=null&&ne(Z),Pe!=null&&ne(Pe))})}))):D?(P={from:(P=D.lower)!==null&&P!==void 0?P:e.MIN_KEY,to:(P=D.upper)!==null&&P!==void 0?P:e.MAX_KEY},F.add(P),N.add(P)):(N.add(r),F.add(r),i.indexes.forEach(function(L){return g(L.name).add(r)})),s.mutate(p).then(function(L){return!D||p.type!=="add"&&p.type!=="put"||(N.addKeys(L.results),m&&m.forEach(function(R){for(var ee=p.values.map(function(Z){return R.extractKey(Z)}),ne=R.keyPath.findIndex(function(Z){return Z===o.keyPath}),se=0,$e=L.results.length;se<$e;++se)ee[se][ne]=L.results[se];g(R.name).addKeys(ee)})),j.mutatedParts=xr(j.mutatedParts||{},C),L})}}),u=function(g){var b=g.query,g=b.index,b=b.range;return[g,new Oe((g=b.lower)!==null&&g!==void 0?g:e.MIN_KEY,(b=b.upper)!==null&&b!==void 0?b:e.MAX_KEY)]},x={get:function(p){return[o,new Oe(p.key)]},getMany:function(p){return[o,new Oe().addKeys(p.keys)]},count:u,query:u,openCursor:u};return E(x).forEach(function(p){v[p]=function(g){var b=$.subscr,y=!!b,w=Gn($,s)&&Qn(p,g)?g.obsSet={}:b;if(y){var j=function(P){return P="idb://".concat(t,"/").concat(n,"/").concat(P),w[P]||(w[P]=new Oe)},C=j(""),N=j(":dels"),b=x[p](g),y=b[0],b=b[1];if((p==="query"&&y.isPrimaryKey&&!g.values?N:j(y.name||"")).add(b),!y.isPrimaryKey){if(p!=="count"){var F=p==="query"&&h&&g.values&&s.query(d(d({},g),{values:!1}));return s[p].apply(this,arguments).then(function(P){if(p==="query"){if(h&&g.values)return F.then(function(ee){return ee=ee.result,C.addKeys(ee),P});var I=g.values?P.result.map(c):P.result;(g.values?C:N).addKeys(I)}else if(p==="openCursor"){var L=P,R=g.values;return L&&Object.create(L,{key:{get:function(){return N.addKey(L.primaryKey),L.key}},primaryKey:{get:function(){var ee=L.primaryKey;return N.addKey(ee),ee}},value:{get:function(){return R&&C.addKey(L.primaryKey),L.value}}})}return P})}N.add(r)}}return s[p].apply(this,arguments)}}),v}})}};function Zn(e,t,r){if(r.numFailures===0)return t;if(t.type==="deleteRange")return null;var n=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return r.numFailures===n?null:(t=d({},t),B(t.keys)&&(t.keys=t.keys.filter(function(s,i){return!(i in r.failures)})),"values"in t&&B(t.values)&&(t.values=t.values.filter(function(s,i){return!(i in r.failures)})),t)}function fn(e,t){return r=e,((n=t).lower===void 0||(n.lowerOpen?0<oe(r,n.lower):0<=oe(r,n.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?oe(e,t.upper)<0:oe(e,t.upper)<=0));var r,n}function Jn(e,t,x,n,s,i){if(!x||x.length===0)return e;var o=t.query.index,c=o.multiEntry,h=t.query.range,m=n.schema.primaryKey.extractKey,v=o.extractKey,u=(o.lowLevelIndex||o).extractKey,x=x.reduce(function(p,g){var b=p,y=[];if(g.type==="add"||g.type==="put")for(var w=new Oe,j=g.values.length-1;0<=j;--j){var C,N=g.values[j],F=m(N);w.hasKey(F)||(C=v(N),(c&&B(C)?C.some(function(L){return fn(L,h)}):fn(C,h))&&(w.addKey(F),y.push(N)))}switch(g.type){case"add":var A=new Oe().addKeys(t.values?p.map(function(R){return m(R)}):p),b=p.concat(t.values?y.filter(function(R){return R=m(R),!A.hasKey(R)&&(A.addKey(R),!0)}):y.map(function(R){return m(R)}).filter(function(R){return!A.hasKey(R)&&(A.addKey(R),!0)}));break;case"put":var D=new Oe().addKeys(g.values.map(function(R){return m(R)}));b=p.filter(function(R){return!D.hasKey(t.values?m(R):R)}).concat(t.values?y:y.map(function(R){return m(R)}));break;case"delete":var P=new Oe().addKeys(g.keys);b=p.filter(function(R){return!P.hasKey(t.values?m(R):R)});break;case"deleteRange":var I=g.range;b=p.filter(function(R){return!fn(m(R),I)})}return b},e);return x===e?e:(x.sort(function(p,g){return oe(u(p),u(g))||oe(m(p),m(g))}),t.limit&&t.limit<1/0&&(x.length>t.limit?x.length=t.limit:e.length===t.limit&&x.length<t.limit&&(s.dirty=!0)),i?Object.freeze(x):x)}function es(e,t){return oe(e.lower,t.lower)===0&&oe(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Ks(e,t){return function(r,n,s,i){if(r===void 0)return n!==void 0?-1:0;if(n===void 0)return 1;if((n=oe(r,n))===0){if(s&&i)return 0;if(s)return 1;if(i)return-1}return n}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(r,n,s,i){if(r===void 0)return n!==void 0?1:0;if(n===void 0)return-1;if((n=oe(r,n))===0){if(s&&i)return 0;if(s)return-1;if(i)return 1}return n}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Ms(e,t,r,n){e.subscribers.add(r),n.addEventListener("abort",function(){var s,i;e.subscribers.delete(r),e.subscribers.size===0&&(s=e,i=t,setTimeout(function(){s.subscribers.size===0&&re(i,s)},3e3))})}var Rs={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return d(d({},e),{transaction:function(r,n,s){var i,o,c=e.transaction(r,n,s);return n==="readwrite"&&(o=(i=new AbortController).signal,s=function(h){return function(){if(i.abort(),n==="readwrite"){for(var m=new Set,v=0,u=r;v<u.length;v++){var x=u[v],p=wt["idb://".concat(t,"/").concat(x)];if(p){var g=e.table(x),b=p.optimisticOps.filter(function(R){return R.trans===c});if(c._explicit&&h&&c.mutatedParts)for(var y=0,w=Object.values(p.queries.query);y<w.length;y++)for(var j=0,C=(A=w[y]).slice();j<C.length;j++)sn((D=C[j]).obsSet,c.mutatedParts)&&(re(A,D),D.subscribers.forEach(function(R){return m.add(R)}));else if(0<b.length){p.optimisticOps=p.optimisticOps.filter(function(R){return R.trans!==c});for(var N=0,F=Object.values(p.queries.query);N<F.length;N++)for(var A,D,P,I=0,L=(A=F[N]).slice();I<L.length;I++)(D=L[I]).res!=null&&c.mutatedParts&&(h&&!D.dirty?(P=Object.isFrozen(D.res),P=Jn(D.res,D.req,b,g,D,P),D.dirty?(re(A,D),D.subscribers.forEach(function(R){return m.add(R)})):P!==D.res&&(D.res=P,D.promise=K.resolve({result:P}))):(D.dirty&&re(A,D),D.subscribers.forEach(function(R){return m.add(R)})))}}}m.forEach(function(R){return R()})}}},c.addEventListener("abort",s(!1),{signal:o}),c.addEventListener("error",s(!1),{signal:o}),c.addEventListener("complete",s(!0),{signal:o})),c},table:function(r){var n=e.table(r),s=n.schema.primaryKey;return d(d({},n),{mutate:function(i){var o=$.trans;if(s.outbound||o.db._options.cache==="disabled"||o.explicit||o.idbtrans.mode!=="readwrite")return n.mutate(i);var c=wt["idb://".concat(t,"/").concat(r)];return c?(o=n.mutate(i),i.type!=="add"&&i.type!=="put"||!(50<=i.values.length||dn(s,i).some(function(h){return h==null}))?(c.optimisticOps.push(i),i.mutatedParts&&wr(i.mutatedParts),o.then(function(h){0<h.numFailures&&(re(c.optimisticOps,i),(h=Zn(0,i,h))&&c.optimisticOps.push(h),i.mutatedParts&&wr(i.mutatedParts))}),o.catch(function(){re(c.optimisticOps,i),i.mutatedParts&&wr(i.mutatedParts)})):o.then(function(h){var m=Zn(0,d(d({},i),{values:i.values.map(function(v,u){var x;return h.failures[u]?v:(v=(x=s.keyPath)!==null&&x!==void 0&&x.includes(".")?T(v):d({},v),ce(v,s.keyPath,h.results[u]),v)})}),h);c.optimisticOps.push(m),queueMicrotask(function(){return i.mutatedParts&&wr(i.mutatedParts)})}),o):n.mutate(i)},query:function(i){if(!Gn($,n)||!Qn("query",i))return n.query(i);var o=((m=$.trans)===null||m===void 0?void 0:m.db._options.cache)==="immutable",u=$,c=u.requery,h=u.signal,m=function(g,b,y,w){var j=wt["idb://".concat(g,"/").concat(b)];if(!j)return[];if(!(b=j.queries[y]))return[null,!1,j,null];var C=b[(w.query?w.query.index.name:null)||""];if(!C)return[null,!1,j,null];switch(y){case"query":var N=C.find(function(F){return F.req.limit===w.limit&&F.req.values===w.values&&es(F.req.query.range,w.query.range)});return N?[N,!0,j,C]:[C.find(function(F){return("limit"in F.req?F.req.limit:1/0)>=w.limit&&(!w.values||F.req.values)&&Ks(F.req.query.range,w.query.range)}),!1,j,C];case"count":return N=C.find(function(F){return es(F.req.query.range,w.query.range)}),[N,!!N,j,C]}}(t,r,"query",i),v=m[0],u=m[1],x=m[2],p=m[3];return v&&u?v.obsSet=i.obsSet:(u=n.query(i).then(function(g){var b=g.result;if(v&&(v.res=b),o){for(var y=0,w=b.length;y<w;++y)Object.freeze(b[y]);Object.freeze(b)}else g.result=T(b);return g}).catch(function(g){return p&&v&&re(p,v),Promise.reject(g)}),v={obsSet:i.obsSet,promise:u,subscribers:new Set,type:"query",req:i,dirty:!1},p?p.push(v):(p=[v],(x=x||(wt["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[i.query.index.name||""]=p)),Ms(v,p,c,h),v.promise.then(function(g){return{result:Jn(g.result,i,x?.optimisticOps,n,v,o)}})}})}})}};function jr(e,t){return new Proxy(e,{get:function(r,n,s){return n==="db"?t:Reflect.get(r,n,s)}})}var tt=(_e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new U.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new U.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,r=t.filter(function(n){return n._cfg.version===e})[0];return r||(r=new this.Version(e),t.push(r),t.sort(Es),r.stores({}),this._state.autoSchema=!1,r)},_e.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||$.letThrough||this._vip)?e():new K(function(r,n){if(t._state.openComplete)return n(new U.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void n(new U.DatabaseClosed);t.open().catch(fe)}t._state.dbReadyPromise.then(r,n)}).then(e)},_e.prototype.use=function(e){var t=e.stack,r=e.create,n=e.level,s=e.name;return s&&this.unuse({stack:t,name:s}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:r,level:n??10,name:s}),e.sort(function(i,o){return i.level-o.level}),this},_e.prototype.unuse=function(e){var t=e.stack,r=e.name,n=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(s){return n?s.create!==n:!!r&&s.name!==r})),this},_e.prototype.open=function(){var e=this;return vt(it,function(){return Ps(e)})},_e.prototype._close=function(){var e=this._state,t=Dt.indexOf(this);if(0<=t&&Dt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new K(function(r){e.dbReadyResolve=r}),e.openCanceller=new K(function(r,n){e.cancelOpen=n}))},_e.prototype.close=function(r){var t=(r===void 0?{disableAutoOpen:!0}:r).disableAutoOpen,r=this._state;t?(r.isBeingOpened&&r.cancelOpen(new U.DatabaseClosed),this._close(),r.autoOpen=!1,r.dbOpenError=new U.DatabaseClosed):(this._close(),r.autoOpen=this._options.autoOpen||r.isBeingOpened,r.openComplete=!1,r.dbOpenError=null)},_e.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var r=0<arguments.length&&typeof arguments[0]!="object",n=this._state;return new K(function(s,i){function o(){t.close(e);var c=t._deps.indexedDB.deleteDatabase(t.name);c.onsuccess=ge(function(){var h,m,v;h=t._deps,m=t.name,v=h.indexedDB,h=h.IDBKeyRange,tn(v)||m===lr||en(v,h).delete(m).catch(fe),s()}),c.onerror=Ge(i),c.onblocked=t._fireOnBlocked}if(r)throw new U.InvalidArgument("Invalid closeOptions argument to db.delete()");n.isBeingOpened?n.dbReadyPromise.then(o):o()})},_e.prototype.backendDB=function(){return this.idbdb},_e.prototype.isOpen=function(){return this.idbdb!==null},_e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},_e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},_e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(_e.prototype,"tables",{get:function(){var e=this;return E(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),_e.prototype.transaction=function(){var e=function(t,r,n){var s=arguments.length;if(s<2)throw new U.InvalidArgument("Too few arguments");for(var i=new Array(s-1);--s;)i[s-1]=arguments[s];return n=i.pop(),[t,qe(i),n]}.apply(this,arguments);return this._transaction.apply(this,e)},_e.prototype._transaction=function(e,t,r){var n=this,s=$.trans;s&&s.db===this&&e.indexOf("!")===-1||(s=null);var i,o,c=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(o=t.map(function(m){if(m=m instanceof n.Table?m.name:m,typeof m!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return m}),e=="r"||e===Vr)i=Vr;else{if(e!="rw"&&e!=$r)throw new U.InvalidArgument("Invalid transaction mode: "+e);i=$r}if(s){if(s.mode===Vr&&i===$r){if(!c)throw new U.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&o.forEach(function(m){if(s&&s.storeNames.indexOf(m)===-1){if(!c)throw new U.SubTransaction("Table "+m+" not included in parent transaction.");s=null}}),c&&s&&!s.active&&(s=null)}}catch(m){return s?s._promise(null,function(v,u){u(m)}):je(m)}var h=function m(v,u,x,p,g){return K.resolve().then(function(){var b=$.transless||$,y=v._createTransaction(u,x,v._dbSchema,p);if(y.explicit=!0,b={trans:y,transless:b},p)y.idbtrans=p.idbtrans;else try{y.create(),y.idbtrans._explicit=!0,v._state.PR1398_maxLoop=3}catch(C){return C.name===Pr.InvalidState&&v.isOpen()&&0<--v._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),v.close({disableAutoOpen:!1}),v.open().then(function(){return m(v,u,x,null,g)})):je(C)}var w,j=Or(g);return j&&Ft(),b=K.follow(function(){var C;(w=g.call(y,y))&&(j?(C=ot.bind(null,null),w.then(C,C)):typeof w.next=="function"&&typeof w.throw=="function"&&(w=cn(w)))},b),(w&&typeof w.then=="function"?K.resolve(w).then(function(C){return y.active?C:je(new U.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):b.then(function(){return w})).then(function(C){return p&&y._resolve(),y._completion.then(function(){return C})}).catch(function(C){return y._reject(C),je(C)})})}.bind(null,this,i,o,s,r);return s?s._promise(i,h,"lock"):$.trans?vt($.transless,function(){return n._whenReady(h)}):this._whenReady(h)},_e.prototype.table=function(e){if(!Y(this._allTables,e))throw new U.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},_e);function _e(e,t){var r=this;this._middlewares={},this.verno=0;var n=_e.dependencies;this._options=t=d({addons:_e.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},n=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s,i,o,c,h,m={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:fe,dbReadyPromise:null,cancelOpen:fe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};m.dbReadyPromise=new K(function(u){m.dbReadyResolve=u}),m.openCanceller=new K(function(u,x){m.cancelOpen=x}),this._state=m,this.name=e,this.on=Vt(this,"populate","blocked","versionchange","close",{ready:[Lr,fe]}),this.on.ready.subscribe=ue(this.on.ready.subscribe,function(u){return function(x,p){_e.vip(function(){var g,b=r._state;b.openComplete?(b.dbOpenError||K.resolve().then(x),p&&u(x)):b.onReadyBeingFired?(b.onReadyBeingFired.push(x),p&&u(x)):(u(x),g=r,p||u(function y(){g.on.ready.unsubscribe(x),g.on.ready.unsubscribe(y)}))})}}),this.Collection=(s=this,$t(ws.prototype,function(w,y){this.db=s;var p=On,g=null;if(y)try{p=y()}catch(j){g=j}var b=w._ctx,y=b.table,w=y.hook.reading.fire;this._ctx={table:y,index:b.index,isPrimKey:!b.index||y.schema.primKey.keyPath&&b.index===y.schema.primKey.name,range:p,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:g,or:b.or,valueMapper:w!==Kt?w:null}})),this.Table=(i=this,$t(In.prototype,function(u,x,p){this.db=i,this._tx=p,this.name=u,this.schema=x,this.hook=i._allTables[u]?i._allTables[u].hook:Vt(null,{creating:[fs,fe],reading:[ds,Kt],updating:[ps,fe],deleting:[hs,fe]})})),this.Transaction=(o=this,$t(_s.prototype,function(u,x,p,g,b){var y=this;this.db=o,this.mode=u,this.storeNames=x,this.schema=p,this.chromeTransactionDurability=g,this.idbtrans=null,this.on=Vt(this,"complete","error","abort"),this.parent=b||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new K(function(w,j){y._resolve=w,y._reject=j}),this._completion.then(function(){y.active=!1,y.on.complete.fire()},function(w){var j=y.active;return y.active=!1,y.on.error.fire(w),y.parent?y.parent._reject(w):j&&y.idbtrans&&y.idbtrans.abort(),je(w)})})),this.Version=(c=this,$t(Os.prototype,function(u){this.db=c,this._cfg={version:u,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(h=this,$t(Bn.prototype,function(u,x,p){if(this.db=h,this._ctx={table:u,index:x===":id"?null:x,or:p},this._cmp=this._ascending=oe,this._descending=function(g,b){return oe(b,g)},this._max=function(g,b){return 0<oe(g,b)?g:b},this._min=function(g,b){return oe(g,b)<0?g:b},this._IDBKeyRange=h._deps.IDBKeyRange,!this._IDBKeyRange)throw new U.MissingAPI})),this.on("versionchange",function(u){0<u.newVersion?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(u){!u.newVersion||u.newVersion<u.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(u.oldVersion/10))}),this._maxKey=Wt(t.IDBKeyRange),this._createTransaction=function(u,x,p,g){return new r.Transaction(u,x,p,r._options.chromeTransactionDurability,g)},this._fireOnBlocked=function(u){r.on("blocked").fire(u),Dt.filter(function(x){return x.name===r.name&&x!==r&&!x._state.vcFired}).map(function(x){return x.on("versionchange").fire(u)})},this.use(Is),this.use(Rs),this.use(Ts),this.use(Ls),this.use(As);var v=new Proxy(this,{get:function(u,x,p){if(x==="_vip")return!0;if(x==="table")return function(b){return jr(r.table(b),v)};var g=Reflect.get(u,x,p);return g instanceof In?jr(g,v):x==="tables"?g.map(function(b){return jr(b,v)}):x==="_createTransaction"?function(){return jr(g.apply(this,arguments),v)}:g}});this.vip=v,n.forEach(function(u){return u(r)})}var _r,Ue=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Bs=(hn.prototype.subscribe=function(e,t,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:r})},hn.prototype[Ue]=function(){return this},hn);function hn(e){this._subscribe=e}try{_r={indexedDB:S.indexedDB||S.mozIndexedDB||S.webkitIndexedDB||S.msIndexedDB,IDBKeyRange:S.IDBKeyRange||S.webkitIDBKeyRange}}catch{_r={indexedDB:null,IDBKeyRange:null}}function ts(e){var t,r=!1,n=new Bs(function(s){var i=Or(e),o,c=!1,h={},m={},v={get closed(){return c},unsubscribe:function(){c||(c=!0,o&&o.abort(),u&&ut.storagemutated.unsubscribe(p))}};s.start&&s.start(v);var u=!1,x=function(){return qr(g)},p=function(b){xr(h,b),sn(m,h)&&x()},g=function(){var b,y,w;!c&&_r.indexedDB&&(h={},b={},o&&o.abort(),o=new AbortController,w=function(j){var C=St();try{i&&Ft();var N=at(e,j);return N=i?N.finally(ot):N}finally{C&&Et()}}(y={subscr:b,signal:o.signal,requery:x,querier:e,trans:null}),Promise.resolve(w).then(function(j){r=!0,t=j,c||y.signal.aborted||(h={},function(C){for(var N in C)if(Y(C,N))return;return 1}(m=b)||u||(ut(Ht,p),u=!0),qr(function(){return!c&&s.next&&s.next(j)}))},function(j){r=!1,["DatabaseClosedError","AbortError"].includes(j?.name)||c||qr(function(){c||s.error&&s.error(j)})}))};return setTimeout(x,0),v});return n.hasValue=function(){return r},n.getValue=function(){return t},n}var kt=tt;function pn(e){var t=dt;try{dt=!0,ut.storagemutated.fire(e),ln(e,!0)}finally{dt=t}}M(kt,d(d({},Jt),{delete:function(e){return new kt(e,{addons:[]}).delete()},exists:function(e){return new kt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=kt.dependencies,r=t.indexedDB,t=t.IDBKeyRange,(tn(r)?Promise.resolve(r.databases()).then(function(n){return n.map(function(s){return s.name}).filter(function(s){return s!==lr})}):en(r,t).toCollection().primaryKeys()).then(e)}catch{return je(new U.MissingAPI)}var t,r},defineClass:function(){return function(e){q(this,e)}},ignoreTransaction:function(e){return $.trans?vt($.transless,e):e()},vip:rn,async:function(e){return function(){try{var t=cn(e.apply(this,arguments));return t&&typeof t.then=="function"?t:K.resolve(t)}catch(r){return je(r)}}},spawn:function(e,t,r){try{var n=cn(e.apply(r,t||[]));return n&&typeof n.then=="function"?n:K.resolve(n)}catch(s){return je(s)}},currentTransaction:{get:function(){return $.trans||null}},waitFor:function(e,t){return t=K.resolve(typeof e=="function"?kt.ignoreTransaction(e):e).timeout(t||6e4),$.trans?$.trans.waitFor(t):t},Promise:K,debug:{get:function(){return Xe},set:function(e){_n(e)}},derive:le,extend:q,props:M,override:ue,Events:Vt,on:ut,liveQuery:ts,extendObservabilitySet:xr,getByKeyPath:we,setByKeyPath:ce,delByKeyPath:function(e,t){typeof t=="string"?ce(e,t,void 0):"length"in t&&[].map.call(t,function(r){ce(e,r,void 0)})},shallowClone:Ne,deepClone:T,getObjectDiff:un,cmp:oe,asap:xe,minKey:-1/0,addons:[],connections:Dt,errnames:Pr,dependencies:_r,cache:wt,semVer:"4.0.11",version:"4.0.11".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,r){return e+t/Math.pow(10,2*r)})})),kt.maxKey=Wt(kt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ut(Ht,function(e){dt||(e=new CustomEvent(Wr,{detail:e}),dt=!0,dispatchEvent(e),dt=!1)}),addEventListener(Wr,function(e){e=e.detail,dt||pn(e)}));var Lt,dt=!1,rs=function(){};return typeof BroadcastChannel<"u"&&((rs=function(){(Lt=new BroadcastChannel(Wr)).onmessage=function(e){return e.data&&pn(e.data)}})(),typeof Lt.unref=="function"&&Lt.unref(),ut(Ht,function(e){dt||Lt.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!tt.disableBfCache&&e.persisted){Xe&&console.debug("Dexie: handling persisted pagehide"),Lt?.close();for(var t=0,r=Dt;t<r.length;t++)r[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!tt.disableBfCache&&e.persisted&&(Xe&&console.debug("Dexie: handling persisted pageshow"),rs(),pn({all:new Oe(-1/0,[[]])}))})),K.rejectionMapper=function(e,t){return!e||e instanceof Ct||e instanceof TypeError||e instanceof SyntaxError||!e.name||!jn[e.name]?e:(t=new jn[e.name](t||e.message,e),"stack"in e&&te(t,"stack",{get:function(){return this.inner.stack}}),t)},_n(Xe),d(tt,Object.freeze({__proto__:null,Dexie:tt,liveQuery:ts,Entity:Pn,cmp:oe,PropModification:zt,replacePrefix:function(e,t){return new zt({replacePrefix:[e,t]})},add:function(e){return new zt({add:e})},remove:function(e){return new zt({remove:e})},default:tt,RangeSet:Oe,mergeRanges:Gt,rangesOverlap:Un}),{default:tt}),tt})}(Er)),Er.exports}var Gs=Xs();const xn=Vs(Gs),is=Symbol.for("Dexie"),Dr=globalThis[is]||(globalThis[is]=xn);if(xn.semVer!==Dr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${xn.semVer} and ${Dr.semVer}`);const{liveQuery:vi,mergeRanges:bi,rangesOverlap:xi,RangeSet:wi,cmp:ki,Entity:ji,PropModification:_i,replacePrefix:Ci,add:Ni,remove:Si}=Dr;class Qs extends Dr{files;lines;csvLines;originalLines;constructor(){super("LineFilterDB"),this.version(1).stores({files:"id, name, type, uploadedAt",lines:"++id, lineNumber",csvLines:"++id, lineNumber"}),this.version(2).stores({files:"id, name, type, uploadedAt",lines:"++id, lineNumber",csvLines:"++id, lineNumber",originalLines:"++id, fileId"})}}class Zs{db;constructor(){this.db=new Qs}async storeTextLines(l,f){try{const d=f.map((k,S)=>({content:k,lineNumber:S+1}));await this.db.transaction("rw",this.db.lines,async()=>{await this.db.lines.clear(),await this.db.lines.bulkAdd(d)})}catch(d){throw new Error(`Failed to store text lines: ${d instanceof Error?d.message:"Unknown error"}`)}}async storeCSVLines(l,f,d){try{const k=f.map((S,E)=>({lineNumber:E+1,data:S,originalContent:S.join(",")}));await this.db.transaction("rw",this.db.csvLines,async()=>{await this.db.csvLines.clear(),await this.db.csvLines.bulkAdd(k)})}catch(k){throw new Error(`Failed to store CSV lines: ${k instanceof Error?k.message:"Unknown error"}`)}}async storeFileData(l){try{await this.db.files.put(l)}catch(f){throw new Error(`Failed to store file data: ${f instanceof Error?f.message:"Unknown error"}`)}}async getFileData(l){try{return await this.db.files.get(l)}catch(f){throw new Error(`Failed to get file data: ${f instanceof Error?f.message:"Unknown error"}`)}}async getTextLines(l,f){try{let d=this.db.lines.orderBy("lineNumber");return f&&(d=d.offset(f)),l&&(d=d.limit(l)),await d.toArray()}catch(d){throw new Error(`Failed to get text lines: ${d instanceof Error?d.message:"Unknown error"}`)}}async getCSVLines(l,f){try{let d=this.db.csvLines.orderBy("lineNumber");return f&&(d=d.offset(f)),l&&(d=d.limit(l)),await d.toArray()}catch(d){throw new Error(`Failed to get CSV lines: ${d instanceof Error?d.message:"Unknown error"}`)}}async getLinesByNumbers(l,f){try{return f==="text"?await this.db.lines.where("lineNumber").anyOf(l).toArray():await this.db.csvLines.where("lineNumber").anyOf(l).toArray()}catch(d){throw new Error(`Failed to get lines by numbers: ${d instanceof Error?d.message:"Unknown error"}`)}}async getLineCount(){try{const[l,f]=await Promise.all([this.db.lines.count(),this.db.csvLines.count()]);return{text:l,csv:f}}catch(l){throw new Error(`Failed to get line count: ${l instanceof Error?l.message:"Unknown error"}`)}}async clearData(){try{await this.db.transaction("rw",[this.db.files,this.db.lines,this.db.csvLines,this.db.originalLines],async()=>{await Promise.all([this.db.files.clear(),this.db.lines.clear(),this.db.csvLines.clear(),this.db.originalLines.clear()])})}catch(l){throw new Error(`Failed to clear data: ${l instanceof Error?l.message:"Unknown error"}`)}}async getAllTextLinesForFiltering(){try{return await this.db.lines.orderBy("lineNumber").toArray()}catch(l){throw new Error(`Failed to get all text lines: ${l instanceof Error?l.message:"Unknown error"}`)}}async getAllCSVLinesForFiltering(){try{return await this.db.csvLines.orderBy("lineNumber").toArray()}catch(l){throw new Error(`Failed to get all CSV lines: ${l instanceof Error?l.message:"Unknown error"}`)}}async hasData(l){try{if(!await this.db.files.get(l))return!1;const d=await this.getLineCount();return d.text>0||d.csv>0}catch(f){return console.warn("Failed to check if data exists:",f),!1}}async storeOriginalLines(l,f){try{await this.db.originalLines.clear(),await this.db.originalLines.add({fileId:l,lines:f})}catch(d){throw new Error(`Failed to store original lines: ${d instanceof Error?d.message:"Unknown error"}`)}}async getOriginalLines(l){try{return(await this.db.originalLines.where("fileId").equals(l).first())?.lines||[]}catch(f){return console.warn("Failed to get original lines:",f),[]}}async clearCSVData(){try{await this.db.csvLines.clear()}catch(l){throw new Error(`Failed to clear CSV data: ${l instanceof Error?l.message:"Unknown error"}`)}}async deleteDatabase(){try{await this.db.delete()}catch(l){throw new Error(`Failed to delete database: ${l instanceof Error?l.message:"Unknown error"}`)}}}const ve=new Zs;class ze{static MAX_FILE_SIZE=5*1024*1024;static MAX_LINES=1e4;static CSV_DELIMITERS=[",",";","	","|"];async parseFile(l,f=!0){this.validateFile(l);const d=await this.readFileContent(l),k=this.splitIntoLines(d);this.validateLineCount(k);const S=this.detectFileType(l,k),E=this.generateFileId(l);if(S==="csv"){const{csvData:B,headers:q,delimiter:V}=this.parseCSV(k,f);return{data:{csvData:B,headers:q},fileInfo:{id:E,name:l.name,type:"csv",size:l.size,lineCount:B.length,headers:q},delimiter:V}}else return{data:{lines:k},fileInfo:{id:E,name:l.name,type:"text",size:l.size,lineCount:k.length}}}parseText(l,f=!0){const d=this.splitIntoLines(l);this.validateLineCount(d);const k=this.detectTextType(d),S=this.generateTextId();if(k==="csv"){const{csvData:E,headers:B,delimiter:q}=this.parseCSV(d,f);return{data:{csvData:E,headers:B},fileInfo:{id:S,name:"Pasted Text",type:"csv",size:l.length,lineCount:E.length,headers:B},delimiter:q}}else return{data:{lines:d},fileInfo:{id:S,name:"Pasted Text",type:"text",size:l.length,lineCount:d.length}}}detectFileType(l,f){const d=l.name.toLowerCase().split(".").pop();return d==="csv"||d==="tsv"?"csv":this.detectTextType(f)}detectTextType(l){if(l.length===0)return"text";const f=Math.min(5,l.length),d=l.slice(0,f);for(const k of ze.CSV_DELIMITERS)if(this.looksLikeCSV(d,k))return"csv";return"text"}looksLikeCSV(l,f){if(l.length<2)return!1;const d=l.map(E=>E.split(f).length),k=d[0];return k<2?!1:d.every(E=>E===k)}extractCSVHeaders(l,f=",",d=!0){if(l.length===0)return[];if(d)return l[0].split(f).map(k=>k.trim().replace(/^["']|["']$/g,""));{const k=l[0].split(f).length;return Array.from({length:k},(S,E)=>`Column ${E+1}`)}}parseCSV(l,f=!0){let d=",",k=0;for(const q of ze.CSV_DELIMITERS)if(l.length>0){const V=l[0].split(q).length;V>k&&this.looksLikeCSV(l.slice(0,Math.min(3,l.length)),q)&&(k=V,d=q)}const S=this.extractCSVHeaders(l,d,f);return{csvData:(f?l.slice(1):l).map(q=>q.split(d).map(V=>V.trim().replace(/^["']|["']$/g,""))),headers:S,delimiter:d}}validateFile(l){if(l.size>ze.MAX_FILE_SIZE)throw new Error(`File size exceeds maximum limit of ${ze.MAX_FILE_SIZE/1024/1024}MB`)}validateLineCount(l){if(l.length>ze.MAX_LINES)throw new Error(`File contains ${l.length} lines, which exceeds the maximum limit of ${ze.MAX_LINES} lines`)}async readFileContent(l){return new Promise((f,d)=>{const k=new FileReader;k.onload=S=>{S.target?.result?f(S.target.result):d(new Error("Failed to read file content"))},k.onerror=()=>{d(new Error("File reading failed"))},k.readAsText(l)})}splitIntoLines(l){return l.split(/\r?\n/).filter(f=>f.trim().length>0)}generateFileId(l){return`file_${Date.now()}_${Math.random().toString(36).substr(2,9)}_${l.name.replace(/[^a-zA-Z0-9]/g,"")}`}generateTextId(){return`text_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static getMaxFileSize(){return ze.MAX_FILE_SIZE}static getMaxLines(){return ze.MAX_LINES}static getSupportedDelimiters(){return[...ze.CSV_DELIMITERS]}reParseCSV(l,f){return this.parseCSV(l,f)}}const yn=new ze;class Js{worker=null;isInitialized=!1;callbacks={};currentData=null;currentDataType=null;async initialize(){if(!this.isInitialized)try{this.worker=new Worker("/filter.worker.js"),this.setupWorkerListeners(),await new Promise((l,f)=>{const d=setTimeout(()=>{f(new Error("Worker initialization timeout"))},5e3),k=S=>{S.data.type==="ready"&&(clearTimeout(d),this.worker?.removeEventListener("message",k),l())};this.worker?.addEventListener("message",k)}),this.isInitialized=!0}catch(l){throw new Error(`Failed to initialize worker: ${l instanceof Error?l.message:"Unknown error"}`)}}async setData(l,f){if(!this.worker||!this.isInitialized)throw new Error("Worker not initialized");return this.currentData=l,this.currentDataType=f,new Promise((d,k)=>{const S=setTimeout(()=>{k(new Error("Set data timeout"))},1e4),E=B=>{B.data.type==="dataSet"?(clearTimeout(S),this.worker?.removeEventListener("message",E),B.data.payload.success?d():k(new Error("Failed to set data in worker"))):B.data.type==="error"&&(clearTimeout(S),this.worker?.removeEventListener("message",E),k(new Error(B.data.payload.error)))};this.worker?.addEventListener("message",E),this.worker?.postMessage({type:"setData",payload:{data:l,dataType:f}})})}async filter(l,f={}){if(!this.worker||!this.isInitialized)throw new Error("Worker not initialized");if(!this.currentData)throw new Error("No data loaded in worker");return this.callbacks=f,new Promise((d,k)=>{const S=setTimeout(()=>{k(new Error("Filter operation timeout"))},3e4),E=B=>{const{type:q,payload:V}=B.data;switch(q){case"progress":V.filterId===l.filterId&&f.onProgress&&f.onProgress(V.filterId,V.progress,V.processedLines,V.totalLines);break;case"complete":if(V.filterId===l.filterId){clearTimeout(S),this.worker?.removeEventListener("message",E);const Y={filterId:V.filterId,matchedLines:V.matchedLines,totalMatches:V.totalMatches,processingTime:V.processingTime};f.onComplete&&f.onComplete(Y),d(Y)}break;case"error":clearTimeout(S),this.worker?.removeEventListener("message",E);const H=V.error||"Unknown worker error";f.onError&&f.onError(l.filterId,H),k(new Error(H));break}};this.worker?.addEventListener("message",E),this.worker?.postMessage({type:"filter",payload:l})})}clearData(){this.worker&&this.isInitialized&&(this.worker.postMessage({type:"clear"}),this.currentData=null,this.currentDataType=null)}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.isInitialized=!1,this.currentData=null,this.currentDataType=null,this.callbacks={})}setupWorkerListeners(){this.worker&&(this.worker.addEventListener("error",l=>{console.error("Worker error:",l),this.callbacks.onError&&this.callbacks.onError("unknown",`Worker error: ${l.message}`)}),this.worker.addEventListener("messageerror",l=>{console.error("Worker message error:",l),this.callbacks.onError&&this.callbacks.onError("unknown","Worker message error")}))}isReady(){return this.isInitialized&&this.worker!==null}hasData(){return this.currentData!==null}getDataInfo(){return{lineCount:this.currentData?this.currentData.length:0,dataType:this.currentDataType}}}const Re=new Js,Be=De("none"),Ye=De(0),Ze=De([]),We=De(!0),st=De(","),ft=De(null),At=De(null),Ae=De("idle"),Se=De(0),Me=De(null),Ce=os({}),He=os({}),_t=De(!1),gn=De(0),vn=De(!1),bn=De(null),nt=De(1),wn=De(100),as=De(null),Fr=Qt([Be,Ye],(_,l)=>_!=="none"&&l>0),ls=Qt([Fr,_t],(_,l)=>_&&!l);Qt(Ce,_=>Object.keys(_).length);Qt(He,_=>Object.values(_).reduce((l,f)=>l+f.totalMatches,0));Qt(Ae,_=>_!=="idle"&&_!=="complete"&&_!=="error");const ke={async loadFile(_){try{Ae.set("uploading"),Se.set(0),Me.set(null);const l=We.get(),f=await yn.parseFile(_,l);Ae.set("parsing"),Se.set(30);const d={...f.fileInfo,uploadedAt:new Date};if(await ve.storeFileData(d),Se.set(60),f.fileInfo.type==="csv"&&f.data.csvData){const E=(await _.text()).split(/\r?\n/).filter(B=>B.trim().length>0);await ve.storeOriginalLines(d.id,E),await ve.storeCSVLines(d.id,f.data.csvData,f.data.headers),Ze.set(f.data.headers||[]),st.set(f.delimiter||",")}else f.data.lines&&await ve.storeTextLines(d.id,f.data.lines);Se.set(80),Re.isReady()||await Re.initialize();let k;f.fileInfo.type==="csv"?k=await ve.getAllCSVLinesForFiltering():k=await ve.getAllTextLinesForFiltering(),await Re.setData(k,f.fileInfo.type),Be.set(f.fileInfo.type),Ye.set(f.fileInfo.lineCount),ft.set(d.id),At.set(d.name),Se.set(100),Ae.set("complete"),rt()}catch(l){const f=l instanceof Error?l.message:"Failed to load file";throw Me.set(f),Ae.set("error"),l}},async loadText(_){try{Ae.set("parsing"),Se.set(0),Me.set(null);const l=We.get(),f=yn.parseText(_,l);Se.set(30);const d={...f.fileInfo,uploadedAt:new Date};if(await ve.storeFileData(d),Se.set(60),f.fileInfo.type==="csv"&&f.data.csvData){const S=_.split(/\r?\n/).filter(E=>E.trim().length>0);await ve.storeOriginalLines(d.id,S),await ve.storeCSVLines(d.id,f.data.csvData,f.data.headers),Ze.set(f.data.headers||[]),st.set(f.delimiter||",")}else f.data.lines&&await ve.storeTextLines(d.id,f.data.lines);Se.set(80),Re.isReady()||await Re.initialize();let k;f.fileInfo.type==="csv"?k=await ve.getAllCSVLinesForFiltering():k=await ve.getAllTextLinesForFiltering(),await Re.setData(k,f.fileInfo.type),Be.set(f.fileInfo.type),Ye.set(f.fileInfo.lineCount),ft.set(d.id),At.set(d.name),Se.set(100),Ae.set("complete"),rt()}catch(l){const f=l instanceof Error?l.message:"Failed to load text";throw Me.set(f),Ae.set("error"),l}},async addFilter(_){const l=Ce.get();Ce.set({...l,[_.id]:_});try{await this.applyFilter(_.id),rt()}catch(f){throw console.error("Failed to auto-apply filter:",f),this.removeFilter(_.id),f}},removeFilter(_){const f={...Ce.get()};delete f[_],Ce.set(f);const k={...He.get()};delete k[_],He.set(k),nt.set(1),rt()},updateFilter(_,l){const f=Ce.get(),d=f[_];d&&(Ce.set({...f,[_]:{...d,...l}}),rt())},toggleFilter(_){const f=Ce.get()[_];f&&this.updateFilter(_,{isActive:!f.isActive})},async applyFilter(_){const l=Ce.get()[_];if(!l)throw new Error("Filter not found");try{_t.set(!0),Me.set(null);const f={filterId:l.id,pattern:l.pattern,filterType:l.type,caseSensitive:l.caseSensitive,useRegex:l.useRegex,columnIndex:"columnIndex"in l?l.columnIndex:void 0,scope:"scope"in l?l.scope:"all"},d=await Re.filter(f,{onProgress:(S,E)=>{Se.set(E)},onError:(S,E)=>{Me.set(E)}}),k=He.get();return He.set({...k,[_]:d}),nt.set(1),gn.set(Date.now()),d}catch(f){const d=f instanceof Error?f.message:"Filter operation failed";throw Me.set(d),f}finally{_t.set(!1)}},async applyAllActiveFilters(){const _=Ce.get(),l=Object.keys(_).filter(f=>_[f].isActive);for(const f of l)await this.applyFilter(f)},clearFilters(){Ce.set({}),He.set({}),nt.set(1),rt()},async clearAllData(){try{await ve.clearData(),Re.clearData(),Be.set("none"),Ye.set(0),Ze.set([]),We.set(!0),st.set(","),ft.set(null),At.set(null),Ae.set("idle"),Se.set(0),Me.set(null),Ce.set({}),He.set({}),_t.set(!1),gn.set(0),nt.set(1),ti()}catch(_){const l=_ instanceof Error?_.message:"Failed to clear data";throw Me.set(l),_}},openModal(){vn.set(!0)},closeModal(){vn.set(!1),bn.set(null)},selectFilter(_){bn.set(_)},setFocus(_){as.set(_)},setPage(_){nt.set(_)},async setHasHeaders(_){const l=Be.get(),f=ft.get();if(l!=="csv"||!f){We.set(_),rt();return}try{Ae.set("parsing"),Se.set(0);const d=await this.getOriginalCSVLines();if(d.length===0){We.set(_),rt(),Ae.set("complete");return}Se.set(30);const{csvData:k,headers:S,delimiter:E}=yn.reParseCSV(d,_);if(Se.set(60),await ve.clearCSVData(),await ve.storeCSVLines(f,k,S),Se.set(80),We.set(_),Ze.set(S),Ye.set(k.length),st.set(E),Ce.set({}),He.set({}),nt.set(1),Re.isReady()){const B=await ve.getAllCSVLinesForFiltering();await Re.setData(B,"csv")}Se.set(100),Ae.set("complete"),rt()}catch(d){console.error("Failed to update header setting:",d),Me.set("Failed to update header setting"),Ae.set("error")}},async getOriginalCSVLines(){const _=ft.get();return _?await ve.getOriginalLines(_):[]},setDelimiter(_){st.set(_)},getState(){return{data:{fileId:ft.get(),fileName:At.get(),dataType:Be.get(),lineCount:Ye.get(),csvHeaders:Ze.get(),hasHeaders:We.get(),delimiter:st.get()},processing:{status:Ae.get(),progress:Se.get(),error:Me.get()},filters:{active:Object.keys(Ce.get()),results:Object.values(He.get()),isFiltering:_t.get(),lastFilterTime:gn.get()},ui:{isModalOpen:vn.get(),selectedFilter:bn.get(),currentPage:nt.get(),pageSize:wn.get(),focusedElement:as.get()}}}},It="lineFilterState",rt=()=>{try{const _={fileId:ft.get()||"",fileName:At.get()||"",dataType:Be.get(),lineCount:Ye.get(),csvHeaders:Ze.get(),hasHeaders:We.get(),delimiter:st.get(),activeFilters:Ce.get(),timestamp:Date.now()};_.dataType!=="none"&&_.fileId&&localStorage.setItem(It,JSON.stringify(_))}catch(_){console.warn("Failed to save state to localStorage:",_)}},ei=async()=>{try{const _=localStorage.getItem(It);if(!_)return!1;const l=JSON.parse(_),f=1440*60*1e3;if(Date.now()-l.timestamp>f||!await ve.hasData(l.fileId))return localStorage.removeItem(It),!1;ft.set(l.fileId),At.set(l.fileName),Be.set(l.dataType),Ye.set(l.lineCount),Ze.set(l.csvHeaders),We.set(l.hasHeaders),st.set(l.delimiter),Ce.set(l.activeFilters),Re.isReady()||await Re.initialize();let k;l.dataType==="csv"?k=await ve.getAllCSVLinesForFiltering():k=await ve.getAllTextLinesForFiltering(),await Re.setData(k,l.dataType);const S=Object.values(l.activeFilters).filter(E=>E.isActive);for(const E of S)try{await ke.applyFilter(E.id)}catch(B){console.warn("Failed to restore filter:",E.id,B)}return!0}catch(_){return console.warn("Failed to restore state from localStorage:",_),localStorage.removeItem(It),!1}},ti=()=>{try{localStorage.removeItem(It)}catch(_){console.warn("Failed to clear stored state:",_)}},ri=async()=>{try{await Re.initialize(),await ei()&&console.log("Restored previous line filter session")}catch(_){console.error("Failed to initialize line filter store:",_),Me.set("Failed to initialize filtering system")}};class ni{shortcuts=new Map;isEnabled=!0;isBrowser;constructor(){this.isBrowser=typeof window<"u",this.isBrowser&&document.addEventListener("keydown",this.handleKeyDown.bind(this))}generateShortcutId(l){const f=[l.ctrlKey?"Ctrl":"",l.metaKey?"Meta":"",l.shiftKey?"Shift":"",l.altKey?"Alt":""].filter(Boolean).join("+");return f?`${f}+${l.key}`:l.key}register(l){const f=this.generateShortcutId(l);return this.shortcuts.set(f,{...l,id:f}),f}unregister(l){return this.shortcuts.delete(l)}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}handleKeyDown(l){if(!this.isEnabled)return;const f=l.target;if(f.tagName==="INPUT"||f.tagName==="TEXTAREA"||f.isContentEditable){const d=(l.metaKey||l.ctrlKey)&&l.key==="k",k=(l.metaKey||l.ctrlKey)&&l.key==="Enter";if(!d&&!k)return}for(const d of this.shortcuts.values())if(l.key.toLowerCase()===d.key.toLowerCase()&&!!l.ctrlKey==!!d.ctrlKey&&!!l.metaKey==!!d.metaKey&&!!l.shiftKey==!!d.shiftKey&&!!l.altKey==!!d.altKey){d.handler(l);return}}getShortcuts(){return Array.from(this.shortcuts.values())}formatShortcut(l){const f=this.shortcuts.get(l);if(!f)return"";const d=[];f.ctrlKey&&d.push("Ctrl"),f.metaKey&&d.push("â"),f.shiftKey&&d.push("â§"),f.altKey&&d.push("â¥");let k=f.key;return k===" "?k="Space":k==="ArrowUp"?k="â":k==="ArrowDown"?k="â":k==="ArrowLeft"?k="â":k==="ArrowRight"?k="â":k==="Enter"?k="âµ":k==="Escape"?k="Esc":k.length===1&&(k=k.toUpperCase()),d.push(k),d.join("+")}}const si=()=>new ni,Tt=typeof window<"u"?si():{register:()=>"",unregister:()=>!1,enable:()=>{},disable:()=>{},getShortcuts:()=>[],formatShortcut:()=>""},ii=({className:_=""})=>{const[l,f]=O.useState(!1),[d,k]=O.useState(""),[S,E]=O.useState("both"),B=O.useRef(null),q=ie(Ae),V=ie(Se),H=ie(Me),Y=ie(We),M=q==="uploading"||q==="parsing",J=O.useMemo(()=>{if(!d.trim())return null;const T=d.split(`
`).filter(X=>X.trim().length>0);if(T.length<2)return null;const W=[{char:",",name:"Comma"},{char:";",name:"Semicolon"},{char:"	",name:"Tab"}];for(const X of W){const Q=T[0].split(X.char).length;if(Q>1&&T.slice(0,Math.min(3,T.length)).every(re=>re.split(X.char).length===Q))return{delimiter:X.name,columns:Q,format:`${X.name} CSV (${Q} columns)`}}return null},[d]),te=d.split(`
`).filter(T=>T.trim().length>0).length,le=d.trim().length>0,me=O.useCallback(async T=>{try{E("file-focused"),k(""),await ke.loadFile(T)}catch(W){console.error("File upload failed:",W),E("both")}},[]),he=O.useCallback(T=>{const W=T.target.files?.[0];W&&me(W)},[me]),be=O.useCallback(T=>{T.preventDefault(),f(!1);const W=T.dataTransfer.files[0];W&&me(W)},[me]),ue=O.useCallback(T=>{T.preventDefault(),f(!0)},[]),ye=O.useCallback(T=>{T.preventDefault(),f(!1)},[]),xe=O.useCallback(()=>{B.current?.click()},[]),we=O.useCallback(T=>{const W=T.target.value;k(W),W.trim()?E("text-focused"):S==="text-focused"&&E("both")},[S]),ce=O.useCallback(T=>{const W=T.clipboardData.getData("text");W&&(k(W),E("text-focused"))},[]),Ne=O.useCallback(async()=>{if(d.trim())try{await ke.loadText(d),k(""),E("both")}catch(T){console.error("Text processing failed:",T)}},[d]),Ke=O.useCallback(()=>{k(""),E("both")},[]),qe=ze.getMaxFileSize(),ae=ze.getMaxLines(),G=Math.round(qe/1024/1024);return a.jsx("div",{className:`${_}`,children:a.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-all duration-200",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Add Your Data"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Upload a file or paste text directly"})]})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:`
              relative border-2 border-dashed rounded-lg text-center transition-all duration-200
              ${l?"border-blue-400 bg-blue-50 scale-[1.01]":"border-gray-300 hover:border-blue-300"}
              ${S==="text-focused"?"opacity-60 bg-gray-50":"opacity-100"}
              ${M?"opacity-50 cursor-not-allowed":"cursor-pointer hover:bg-gray-50"}
            `,onDrop:be,onDragOver:ue,onDragLeave:ye,onClick:M?void 0:xe,children:[a.jsx("input",{ref:B,type:"file",accept:".txt,.csv,.tsv,.log",onChange:he,className:"hidden",disabled:M}),a.jsxs("div",{className:"py-8",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("svg",{className:`w-10 h-10 ${l?"text-blue-500":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),a.jsx("p",{className:"text-base font-medium text-gray-700 mb-2",children:l?"Drop your file here":"Drop file or click to browse"}),a.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Supports .txt, .csv, .tsv, .log files"}),a.jsxs("div",{className:"inline-flex items-center space-x-3 text-xs text-gray-400 bg-gray-50 px-3 py-2 rounded-full",children:[a.jsxs("span",{children:["Max: ",G,"MB"]}),a.jsx("span",{children:"â¢"}),a.jsxs("span",{children:[ae.toLocaleString()," lines"]})]})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-200"})}),a.jsx("div",{className:"relative flex justify-center",children:a.jsx("span",{className:"bg-white px-4 text-sm font-medium text-gray-500",children:"OR"})})]}),a.jsx("div",{className:`transition-all duration-200 ${S==="file-focused"?"opacity-60 bg-gray-50 rounded-lg":"opacity-100"}`,children:a.jsxs("div",{className:"border border-gray-300 rounded-lg overflow-hidden focus-within:border-blue-500 focus-within:ring-1 focus-within:ring-blue-500",children:[a.jsx("textarea",{value:d,onChange:we,onPaste:ce,placeholder:"Paste your text data here, or start typing...",className:"w-full h-32 p-4 text-sm font-mono resize-none border-0 focus:outline-none focus:ring-0 placeholder-gray-400",disabled:M}),le&&a.jsxs("div",{className:"bg-gray-50 px-4 py-2 border-t border-gray-200 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx("svg",{className:"w-4 h-4 mr-1 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),te," lines ready"]}),J&&a.jsxs("div",{className:"flex items-center text-sm text-blue-600",children:[a.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),J.format]})]}),a.jsx("button",{type:"button",onClick:Ke,className:"text-sm text-gray-500 hover:text-red-600 font-medium",disabled:M,children:"Clear"})]})]})}),J&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("svg",{className:"w-5 h-5 text-blue-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"text-sm font-medium text-blue-900 mb-2",children:["CSV Format Detected: ",J.format]}),a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:Y,onChange:T=>ke.setHasHeaders(T.target.checked),className:"rounded border-blue-300 text-blue-600 focus:ring-blue-500 focus:ring-offset-0",disabled:M}),a.jsx("span",{className:"text-sm text-blue-800",children:"First row contains column headers"})]})]})]})}),M&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium text-blue-900",children:q==="uploading"?"Uploading file...":"Processing data..."}),a.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2 mt-2",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${V}%`}})}),a.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:[V,"% complete"]})]})]})}),H&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm text-red-700 font-medium",children:H})})]})}),!M&&a.jsx("div",{className:"text-center",children:a.jsxs("button",{type:"button",onClick:Ne,disabled:!le,className:`inline-flex items-center px-8 py-4 text-lg font-semibold rounded-lg focus:outline-none focus:ring-4 transform transition-all duration-200 shadow-lg ${le?"text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 hover:scale-105 active:scale-95 focus:ring-blue-300 hover:shadow-xl":"text-gray-500 bg-gray-300 cursor-not-allowed focus:ring-gray-300"}`,children:["Process",a.jsx("svg",{className:"w-5 h-5 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})]})]})})},ai=({className:_=""})=>{const l=ie(Be),f=ie(Ye),d=ie(Ze),k=ie(We);if(ie(st),l==="none")return null;const S=()=>l==="csv"?`${l.toUpperCase()} â¢ ${f.toLocaleString()} lines â¢ ${d.length} columns`:`${l.toUpperCase()} â¢ ${f.toLocaleString()} lines`;return a.jsx("div",{className:`${_}`,children:a.jsxs("div",{className:"inline-flex items-center space-x-2",children:[a.jsxs("div",{className:"flex items-center space-x-2 bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm",children:[a.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.jsx("span",{className:"font-medium",children:S()})]}),l==="csv"&&a.jsxs("label",{className:"flex items-center space-x-1 cursor-pointer text-sm text-gray-600 hover:text-gray-800",children:[a.jsx("input",{type:"checkbox",checked:k,onChange:E=>ke.setHasHeaders(E.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-offset-0 w-3 h-3"}),a.jsx("span",{className:"text-xs",children:"Headers"})]})]})})},oi=({className:_="",onFilterAdded:l,editingFilterId:f,onEditComplete:d})=>{const[k,S]=O.useState(""),[E,B]=O.useState("include"),[q,V]=O.useState(!1),[H,Y]=O.useState(!1),[M,J]=O.useState(!0),[te,le]=O.useState(""),[me,he]=O.useState(!1),be=ie(Be),ue=ie(ls),ye=ie(Ce);O.useEffect(()=>{if(f){const ae=ye[f];ae&&!("scope"in ae)&&(S(ae.pattern),B(ae.type),V(ae.caseSensitive),Y(ae.useRegex),he(!0),J(!0),le(""))}else he(!1)},[f,ye]);const xe=O.useCallback((ae,G)=>{if(!ae.trim())return le("Pattern cannot be empty"),!1;if(G)try{new RegExp(ae)}catch(T){return le(`Invalid regex: ${T instanceof Error?T.message:"Unknown error"}`),!1}return le(""),!0},[]),we=O.useCallback(ae=>{const G=ae.target.value;S(G);const T=xe(G,H);J(T)},[H,xe]);O.useCallback(ae=>{const G=ae.target.checked;Y(G);const T=xe(k,G);J(T)},[k,xe]);const ce=O.useCallback(()=>`filter_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,[]),Ne=O.useCallback(async()=>{if(!(!k.trim()||!M||!ue))if(me&&f){const ae={pattern:k.trim(),type:E,caseSensitive:q,useRegex:H};try{ke.updateFilter(f,ae),await ke.applyFilter(f),S(""),J(!0),le(""),he(!1),d?.()}catch(G){console.error("Failed to update filter:",G),le("Failed to update filter. Please try again.")}}else{const ae={id:ce(),pattern:k.trim(),type:E,caseSensitive:q,useRegex:H,isActive:!0,created:new Date};try{await ke.addFilter(ae),l?.(ae),S(""),J(!0),le("")}catch(G){console.error("Failed to add filter:",G),le("Failed to add filter. Please try again.")}}},[k,E,q,H,M,ue,ce,l,me,f,d]),Ke=O.useCallback(ae=>{ae.key==="Enter"&&(ae.preventDefault(),Ne())},[Ne]);if(be==="none")return null;const qe=O.useCallback(()=>{S(""),J(!0),le(""),he(!1),d?.()},[d]);return a.jsxs("div",{className:`${_}`,children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("input",{type:"text",value:k,onChange:we,onKeyDown:Ke,placeholder:"Filter pattern...",className:`w-full px-3 py-1.5 text-sm border rounded-md focus:outline-none focus:ring-1 ${M?"border-gray-300 focus:ring-blue-500":"border-red-300 focus:ring-red-500"}`,disabled:!ue})}),a.jsxs("select",{value:E,onChange:ae=>B(ae.target.value),className:"px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 bg-white",disabled:!ue,children:[a.jsx("option",{value:"include",children:"Include"}),a.jsx("option",{value:"exclude",children:"Exclude"})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("button",{type:"button",onClick:()=>V(!q),className:`px-1.5 py-1 text-xs rounded ${q?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-100 text-gray-600 border border-gray-300"}`,title:"Case sensitive",disabled:!ue,children:"Aa"}),a.jsx("button",{type:"button",onClick:()=>Y(!H),className:`px-1.5 py-1 text-xs rounded ${H?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-100 text-gray-600 border border-gray-300"}`,title:"Use regex",disabled:!ue,children:".*"})]}),a.jsx("button",{type:"button",onClick:Ne,disabled:!M||!k.trim()||!ue,className:"px-3 py-1.5 bg-blue-600 text-white text-xs font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:me?"Update":"Add"}),me&&a.jsx("button",{type:"button",onClick:qe,className:"px-2 py-1.5 bg-gray-500 text-white text-xs font-medium rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancel"})]}),te&&a.jsx("div",{className:"mt-2",children:a.jsx("p",{className:"text-xs text-red-600",children:te})})]})},li=({className:_="",onFilterAdded:l,editingFilterId:f,onEditComplete:d})=>{const[k,S]=O.useState(""),[E,B]=O.useState("include"),[q,V]=O.useState(!1),[H,Y]=O.useState(!1),[M,J]=O.useState("all"),[te,le]=O.useState(-1),[me,he]=O.useState(!0),[be,ue]=O.useState(""),[ye,xe]=O.useState(!1),we=ie(Be),ce=ie(ls),Ne=ie(Ze),Ke=ie(Ce);O.useEffect(()=>{if(f){const z=Ke[f];z&&"scope"in z&&(S(z.pattern),B(z.type),V(z.caseSensitive),Y(z.useRegex),J(z.scope),le(z.columnIndex||-1),xe(!0),he(!0),ue(""))}else xe(!1)},[f,Ke]);const qe=O.useMemo(()=>Ne.map((z,re)=>({index:re,name:z||`Column ${re+1}`,displayName:z?`${z} (${re+1})`:`Column ${re+1}`})),[Ne]),ae=O.useCallback((z,re)=>{if(!z.trim())return ue("Pattern cannot be empty"),!1;if(re)try{new RegExp(z)}catch(Ie){return ue(`Invalid regex: ${Ie instanceof Error?Ie.message:"Unknown error"}`),!1}return ue(""),!0},[]),G=O.useCallback(z=>{const re=z.target.value;S(re);const Ie=ae(re,H);he(Ie)},[H,ae]);O.useCallback(z=>{const re=z.target.checked;Y(re);const Ie=ae(k,re);he(Ie)},[k,ae]),O.useCallback(z=>{J(z),z==="all"?le(-1):qe.length>0&&te===-1&&le(0)},[qe.length,te]);const T=O.useCallback(()=>`csvfilter_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,[]),W=O.useCallback(async()=>{if(!(!k.trim()||!me||!ce)&&!(M==="column"&&(te===-1||te>=Ne.length)))if(ye&&f){const z={pattern:k.trim(),type:E,caseSensitive:q,useRegex:H,scope:M,columnIndex:M==="column"?te:void 0,columnName:M==="column"?Ne[te]:void 0};try{ke.updateFilter(f,z),await ke.applyFilter(f),S(""),he(!0),ue(""),xe(!1),d?.()}catch(re){console.error("Failed to update filter:",re),ue("Failed to update filter. Please try again.")}}else{const z={id:T(),pattern:k.trim(),type:E,caseSensitive:q,useRegex:H,scope:M,columnIndex:M==="column"?te:void 0,columnName:M==="column"?Ne[te]:void 0,isActive:!0,created:new Date};try{await ke.addFilter(z),l?.(z),S(""),he(!0),ue("")}catch(re){console.error("Failed to add filter:",re),ue("Failed to add filter. Please try again.")}}},[k,E,q,H,M,te,Ne,me,ce,T,l,ye,f,d]),X=O.useCallback(z=>{z.key==="Enter"&&(z.preventDefault(),W())},[W]);if(we!=="csv")return null;Object.keys(Ke).length,k.trim()&&me&&ce&&(M==="all"||M==="column"&&te>=0);const Q=O.useCallback(()=>{S(""),he(!0),ue(""),J("all"),le(-1),xe(!1),d?.()},[d]);return a.jsxs("div",{className:`${_}`,children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("input",{type:"text",value:k,onChange:G,onKeyDown:X,placeholder:"Filter pattern...",className:`w-full px-3 py-1.5 text-sm border rounded-md focus:outline-none focus:ring-1 ${me?"border-gray-300 focus:ring-blue-500":"border-red-300 focus:ring-red-500"}`,disabled:!ce})}),a.jsxs("select",{value:E,onChange:z=>B(z.target.value),className:"px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 bg-white",disabled:!ce,children:[a.jsx("option",{value:"include",children:"Include"}),a.jsx("option",{value:"exclude",children:"Exclude"})]}),a.jsxs("select",{value:M==="column"?te:"all",onChange:z=>{const re=z.target.value;re==="all"?(J("all"),le(-1)):(J("column"),le(parseInt(re)))},className:"px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 bg-white",disabled:!ce,children:[a.jsx("option",{value:"all",children:"All columns"}),Ne.map((z,re)=>a.jsx("option",{value:re,children:z||`Column ${re+1}`},re))]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("button",{type:"button",onClick:()=>V(!q),className:`px-1.5 py-1 text-xs rounded ${q?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-100 text-gray-600 border border-gray-300"}`,title:"Case sensitive",disabled:!ce,children:"Aa"}),a.jsx("button",{type:"button",onClick:()=>Y(!H),className:`px-1.5 py-1 text-xs rounded ${H?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-100 text-gray-600 border border-gray-300"}`,title:"Use regex",disabled:!ce,children:".*"})]}),a.jsx("button",{type:"button",onClick:W,disabled:!me||!k.trim()||!ce,className:"px-3 py-1.5 bg-blue-600 text-white text-xs font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:ye?"Update":"Add"}),ye&&a.jsx("button",{type:"button",onClick:Q,className:"px-2 py-1.5 bg-gray-500 text-white text-xs font-medium rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancel"})]}),be&&a.jsx("div",{className:"mt-2",children:a.jsx("p",{className:"text-xs text-red-600",children:be})})]})},ci=({className:_="",onFilterEdit:l})=>{const f=ie(Ce),d=ie(He),k=ie(_t),S=Object.values(f),E=O.useCallback(M=>{ke.toggleFilter(M)},[]),B=O.useCallback(M=>{ke.removeFilter(M)},[]);O.useCallback(async M=>{try{await ke.applyFilter(M)}catch(J){console.error("Failed to apply filter:",J)}},[]);const q=O.useCallback(async()=>{try{await ke.applyAllActiveFilters()}catch(M){console.error("Failed to apply filters:",M)}},[]),V=O.useCallback(()=>{ke.clearFilters()},[]),H=M=>{const J=`${M.type} "${M.pattern}"`;if("scope"in M&&M.scope==="column"){const te=M.columnName||`Column ${(M.columnIndex||0)+1}`;return`${J} in ${te}`}return J};if(S.length===0)return null;const Y=S.filter(M=>M.isActive).length;return a.jsx("div",{className:`${_}`,children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:Y>0?`${Y} Active`:"No Filters"}),Y>0&&a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",onClick:q,disabled:k,className:"px-2 py-1 bg-blue-600 text-white text-xs font-medium rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Apply"}),a.jsx("button",{type:"button",onClick:V,className:"px-2 py-1 bg-gray-500 text-white text-xs font-medium rounded hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Clear"})]})]}),S.length>0&&a.jsx("div",{className:"flex items-center flex-wrap gap-2",children:S.map(M=>{const J=d[M.id];return a.jsxs("div",{className:`inline-flex items-center space-x-1 px-2 py-1 rounded-full text-xs border transition-colors ${M.isActive?"bg-blue-100 border-blue-300 text-blue-800":"bg-gray-100 border-gray-300 text-gray-600"}`,children:[a.jsx("input",{type:"checkbox",checked:M.isActive,onChange:()=>E(M.id),className:"w-3 h-3 rounded"}),a.jsx("span",{className:"truncate max-w-32",title:H(M),children:H(M)}),J&&a.jsxs("span",{className:"text-xs opacity-75",children:["(",J.totalMatches,")"]}),a.jsxs("div",{className:"flex items-center space-x-0.5",children:[l&&a.jsx("button",{type:"button",onClick:()=>l(M.id),className:"p-0.5 hover:bg-white hover:bg-opacity-50 rounded",title:"Edit filter",children:a.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),a.jsx("button",{type:"button",onClick:()=>B(M.id),className:"p-0.5 hover:bg-red-200 hover:text-red-800 rounded",title:"Remove filter",children:a.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},M.id)})}),k&&a.jsxs("div",{className:"inline-flex items-center space-x-2 text-sm text-blue-600",children:[a.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600"}),a.jsx("span",{children:"Applying..."})]})]})})},ui=({className:_=""})=>{const[l,f]=O.useState([]),[d,k]=O.useState(!1),[S,E]=O.useState(null),[B,q]=O.useState(!1),[V,H]=O.useState(null),Y=ie(He),M=ie(Be),J=ie(nt),te=ie(wn),le=ie(Ye),me=ie(Ce),he=O.useMemo(()=>{if(!(Object.keys(me).length>0))return Array.from({length:le},(X,Q)=>Q+1);const T=Object.values(me).filter(X=>X.isActive).map(X=>Y[X.id]).filter(X=>X!==void 0);if(T.length===0)return[];let W=new Set(T[0].matchedLines);for(let X=1;X<T.length;X++){const Q=new Set(T[X].matchedLines);W=new Set([...W].filter(z=>Q.has(z)))}return Array.from(W).sort((X,Q)=>X-Q)},[Y,me,le]),be=he.length,ue=Math.ceil(be/te),ye=(J-1)*te,xe=ye+te,we=O.useMemo(()=>he.slice(ye,xe),[he,ye,xe]);O.useEffect(()=>{if(M!=="text"||we.length===0){f([]);return}(async()=>{k(!0),E(null);try{const W=(await ve.getLinesByNumbers(we,"text")).sort((X,Q)=>X.lineNumber-Q.lineNumber);f(W)}catch(T){const W=T instanceof Error?T.message:"Failed to load lines";E(W),f([])}finally{k(!1)}})()},[M,we]);const ce=O.useCallback(async()=>{try{const W=(await ve.getLinesByNumbers(he,"text")).sort((X,Q)=>X.lineNumber-Q.lineNumber).map(X=>X.content).join(`
`);await navigator.clipboard.writeText(W),q(!0),setTimeout(()=>q(!1),2e3)}catch(G){console.error("Failed to copy results:",G)}},[he]),Ne=O.useCallback(G=>G,[]);O.useCallback(G=>{H(G)},[]),O.useCallback(()=>{H(null)},[]);const Ke=O.useCallback(G=>{V!==G&&H(G)},[V]),qe=O.useCallback(G=>{G.stopPropagation()},[]),ae=O.useCallback(G=>{V&&H(null)},[V]);return M!=="text"?null:be===0?a.jsx("div",{className:`${_}`,children:a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("p",{children:"No results found"}),a.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Try adjusting your filters"})]})}):a.jsx("div",{className:`${_}`,children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h3",{className:"text-sm font-medium text-gray-900",children:["Results (",be.toLocaleString()," lines)"]}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsx("button",{type:"button",onClick:ce,"data-copy-results":!0,className:`
                px-3 py-1 bg-gray-600 text-white text-xs font-medium rounded
                hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500
              `,children:B?"Copied!":"Copy All"})})]}),d&&a.jsx("div",{className:"text-center py-4",children:a.jsxs("div",{className:"inline-flex items-center space-x-2 text-sm text-gray-600",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}),a.jsx("span",{children:"Loading results..."})]})}),S&&a.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:a.jsx("p",{className:"text-sm text-red-700",children:S})}),!d&&!S&&l.length>0&&a.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[a.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-600",children:["Showing ",ye+1,"-",Math.min(xe,be)," of ",be.toLocaleString()," results"]})}),a.jsx("div",{className:"max-h-[32rem] overflow-y-auto",onClick:ae,children:l.map(G=>a.jsxs("div",{className:`flex border-b border-gray-100 ${V===G.id?"bg-blue-50":"hover:bg-gray-50"}`,onClick:()=>Ke(G.id),children:[a.jsx("div",{className:"flex-shrink-0 w-16 px-3 py-2 bg-gray-50 border-r border-gray-200 text-xs text-gray-500 text-right font-mono",children:G.lineNumber}),a.jsx("div",{className:"flex-1 px-3 py-2 text-sm font-mono",children:V===G.id?a.jsx("textarea",{value:G.content,readOnly:!0,onClick:qe,className:"w-full h-24 p-2 text-sm font-mono border border-blue-300 rounded resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 bg-blue-50"}):a.jsx("pre",{className:"whitespace-pre-wrap break-words max-h-20 overflow-hidden cursor-pointer hover:bg-gray-50 rounded p-1 -m-1",children:Ne(G.content)})})]},G.id))})]}),ue>1&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("p",{className:"text-sm text-gray-700",children:["Page ",J," of ",ue]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"button",onClick:()=>ke.setPage(J-1),disabled:J<=1,className:`
                  px-3 py-1 border border-gray-300 text-sm rounded
                  hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500
                  disabled:opacity-50 disabled:cursor-not-allowed
                `,children:"Previous"}),a.jsx("button",{type:"button",onClick:()=>ke.setPage(J+1),disabled:J>=ue,className:`
                  px-3 py-1 border border-gray-300 text-sm rounded
                  hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500
                  disabled:opacity-50 disabled:cursor-not-allowed
                `,children:"Next"})]})]})]})})},di=({className:_=""})=>{const[l,f]=O.useState([]),[d,k]=O.useState(!1),[S,E]=O.useState(null),[B,q]=O.useState(!1),[V,H]=O.useState(null),Y=ie(He),M=ie(Be),J=ie(Ze),te=ie(nt),le=ie(wn),me=ie(Ye),he=ie(Ce),be=O.useMemo(()=>{if(!(Object.keys(he).length>0))return Array.from({length:me},(Q,z)=>z+1);const W=Object.values(he).filter(Q=>Q.isActive).map(Q=>Y[Q.id]).filter(Q=>Q!==void 0);if(W.length===0)return[];let X=new Set(W[0].matchedLines);for(let Q=1;Q<W.length;Q++){const z=new Set(W[Q].matchedLines);X=new Set([...X].filter(re=>z.has(re)))}return Array.from(X).sort((Q,z)=>Q-z)},[Y,he,me]),ue=be.length,ye=Math.ceil(ue/le),xe=(te-1)*le,we=xe+le,ce=O.useMemo(()=>be.slice(xe,we),[be,xe,we]);O.useEffect(()=>{if(M!=="csv"||ce.length===0){f([]);return}(async()=>{k(!0),E(null);try{const X=(await ve.getLinesByNumbers(ce,"csv")).sort((Q,z)=>Q.lineNumber-z.lineNumber);f(X)}catch(W){const X=W instanceof Error?W.message:"Failed to load lines";E(X),f([])}finally{k(!1)}})()},[M,ce]);const Ne=O.useCallback(async()=>{try{const W=(await ve.getLinesByNumbers(be,"csv")).sort((Q,z)=>Q.lineNumber-z.lineNumber);let X="";J.length>0&&(X+=J.join(",")+`
`),X+=W.map(Q=>Q.originalContent).join(`
`),await navigator.clipboard.writeText(X),q(!0),setTimeout(()=>q(!1),2e3)}catch(T){console.error("Failed to copy results:",T)}},[be,J]),Ke=J;O.useCallback(T=>{H(T)},[]),O.useCallback(()=>{H(null)},[]);const qe=O.useCallback((T,W)=>{W.stopPropagation(),V!==T&&H(T)},[V]),ae=O.useCallback(T=>{T.stopPropagation()},[]),G=O.useCallback(()=>{V&&H(null)},[V]);return M!=="csv"?null:ue===0?a.jsx("div",{className:`${_}`,children:a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),a.jsx("p",{children:"No results found"}),a.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Try adjusting your filters"})]})}):a.jsx("div",{className:`${_}`,children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h3",{className:"text-sm font-medium text-gray-900",children:["CSV Results (",ue.toLocaleString()," rows)"]}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsx("button",{type:"button",onClick:Ne,"data-copy-results":!0,className:`
                px-3 py-1 bg-gray-600 text-white text-xs font-medium rounded
                hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500
              `,children:B?"Copied!":"Copy CSV"})})]}),d&&a.jsx("div",{className:"text-center py-4",children:a.jsxs("div",{className:"inline-flex items-center space-x-2 text-sm text-gray-600",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}),a.jsx("span",{children:"Loading results..."})]})}),S&&a.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:a.jsx("p",{className:"text-sm text-red-700",children:S})}),!d&&!S&&l.length>0&&a.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[a.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-600",children:["Showing ",xe+1,"-",Math.min(we,ue)," of ",ue.toLocaleString()," results",J.length>1&&` (${J.length} columns)`]})}),a.jsx("div",{className:"overflow-x-auto max-h-[32rem] overflow-y-auto",onClick:G,children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Line"}),Ke.map((T,W)=>a.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 last:border-r-0",children:a.jsx("div",{className:"truncate max-w-32",title:T||`Column ${W+1}`,children:T||`Column ${W+1}`})},W))]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(T=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-gray-500 font-mono border-r border-gray-200",children:T.lineNumber}),Ke.map((W,X)=>{const Q=T.data[X]||"",z=`${T.id}-${X}`,re=V===z;return a.jsx("td",{className:`px-3 py-2 text-sm text-gray-900 border-r border-gray-200 last:border-r-0 ${re?"bg-blue-50":""}`,onClick:Ie=>qe(z,Ie),children:re?a.jsx("textarea",{value:Q,readOnly:!0,onClick:ae,className:"w-full h-16 p-2 text-xs font-mono border border-blue-300 rounded resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 bg-blue-50"}):a.jsx("div",{className:"max-w-32 truncate cursor-pointer hover:bg-gray-50 rounded p-1 -m-1",title:Q,children:Q})},X)})]},T.id))})]})})]}),ye>1&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("p",{className:"text-sm text-gray-700",children:["Page ",te," of ",ye]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"button",onClick:()=>ke.setPage(te-1),disabled:te<=1,className:`
                  px-3 py-1 border border-gray-300 text-sm rounded
                  hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500
                  disabled:opacity-50 disabled:cursor-not-allowed
                `,children:"Previous"}),a.jsx("button",{type:"button",onClick:()=>ke.setPage(te+1),disabled:te>=ye,className:`
                  px-3 py-1 border border-gray-300 text-sm rounded
                  hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500
                  disabled:opacity-50 disabled:cursor-not-allowed
                `,children:"Next"})]})]})]})})},fi=({className:_=""})=>{const l=ie(Ae),f=ie(Se),d=ie(Me),k=ie(_t),S=l!=="idle"&&l!=="complete"&&l!=="error",E=S||k;if(!E&&!d)return null;const B=()=>{if(k)return"Filtering data...";switch(l){case"uploading":return"Uploading file...";case"parsing":return"Processing file...";case"complete":return"Complete";case"error":return"Error occurred";default:return"Processing..."}},q=()=>d?"bg-red-500":l==="complete"?"bg-green-500":"bg-blue-500";return a.jsxs("div",{className:`${_}`,children:[E&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:B()}),a.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(f),"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:a.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${q()}`,style:{width:`${f}%`},children:S&&a.jsx("div",{className:"h-full bg-white bg-opacity-30 animate-pulse"})})}),(S||k)&&f===0&&a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:a.jsx("div",{className:"h-2 bg-blue-500 rounded-full animate-pulse"})})]}),d&&a.jsx("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-md",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.96-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Processing Error"}),a.jsx("p",{className:"mt-1 text-sm text-red-700",children:d})]})]})})]})},hi=({isOpen:_,onClose:l})=>{if(!_)return null;const f=Tt.getShortcuts().filter(d=>d.description.toLowerCase().includes("filter")||d.description.toLowerCase().includes("copy")||d.description.toLowerCase().includes("clear"));return a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:l}),a.jsxs("div",{className:"inline-block w-full max-w-2xl p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Line Filter Tool - Help"}),a.jsx("button",{type:"button",onClick:l,className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Overview"}),a.jsx("p",{className:"text-sm text-gray-600",children:"The Line Filter Tool helps you efficiently filter and search through large text files and CSV data. Upload files or paste text, then use include/exclude filters to find exactly what you need."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Features"}),a.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[a.jsxs("li",{children:["â¢ ",a.jsx("strong",{children:"File Support:"})," .txt, .csv, .tsv, .log files up to 5MB and 10,000 lines"]}),a.jsxs("li",{children:["â¢ ",a.jsx("strong",{children:"Text Paste:"})," Paste content directly from clipboard"]}),a.jsxs("li",{children:["â¢ ",a.jsx("strong",{children:"Auto-Detection:"})," Automatically detects CSV format and headers"]}),a.jsxs("li",{children:["â¢ ",a.jsx("strong",{children:"Pattern Matching:"})," Include or exclude lines based on patterns"]}),a.jsxs("li",{children:["â¢ ",a.jsx("strong",{children:"Regex Support:"})," Use regular expressions for complex patterns"]}),a.jsxs("li",{children:["â¢ ",a.jsx("strong",{children:"CSV Filtering:"})," Filter by specific columns or search all data"]}),a.jsxs("li",{children:["â¢ ",a.jsx("strong",{children:"Export Results:"})," Copy filtered results to clipboard"]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Filter Types"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-900",children:"Include Filters:"}),a.jsx("span",{className:"text-gray-600 ml-1",children:"Show only lines that match the pattern"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-900",children:"Exclude Filters:"}),a.jsx("span",{className:"text-gray-600 ml-1",children:"Hide lines that match the pattern"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-900",children:"Column Filters (CSV):"}),a.jsx("span",{className:"text-gray-600 ml-1",children:"Filter specific columns in CSV data"})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Regex Examples"}),a.jsxs("div",{className:"bg-gray-50 rounded p-3 text-sm space-y-1",children:[a.jsxs("div",{children:[a.jsx("code",{className:"bg-white px-1 rounded",children:"^ERROR"}),' - Lines starting with "ERROR"']}),a.jsxs("div",{children:[a.jsxs("code",{className:"bg-white px-1 rounded",children:["\\d",4,"-\\d",2,"-\\d",2]})," - Date patterns (YYYY-MM-DD)"]}),a.jsxs("div",{children:[a.jsx("code",{className:"bg-white px-1 rounded",children:"\\b\\w+@\\w+\\.\\w+\\b"})," - Email addresses"]}),a.jsxs("div",{children:[a.jsx("code",{className:"bg-white px-1 rounded",children:"failed|error|exception"})," - Multiple keywords"]}),a.jsxs("div",{children:[a.jsx("code",{className:"bg-white px-1 rounded",children:"^\\s*$"})," - Empty lines"]})]})]}),f.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Keyboard Shortcuts"}),a.jsxs("div",{className:"space-y-1",children:[f.map(d=>a.jsxs("div",{className:"flex justify-between items-center text-sm",children:[a.jsx("span",{className:"text-gray-600",children:d.description}),a.jsx("kbd",{className:"bg-gray-100 px-2 py-1 rounded text-xs font-mono",children:Tt.formatShortcut(d.id)})]},d.id)),a.jsxs("div",{className:"flex justify-between items-center text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Add filter quickly"}),a.jsx("kbd",{className:"bg-gray-100 px-2 py-1 rounded text-xs font-mono",children:"â+Enter"})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Tips"}),a.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[a.jsx("li",{children:"â¢ Use multiple filters to narrow down results progressively"}),a.jsx("li",{children:"â¢ CSV headers are auto-detected, but you can toggle header detection"}),a.jsx("li",{children:"â¢ Case-sensitive matching is available for precise filtering"}),a.jsx("li",{children:"â¢ Large files are processed in chunks to keep the UI responsive"}),a.jsx("li",{children:"â¢ All processing happens locally in your browser for privacy"})]})]})]}),a.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:a.jsx("button",{type:"button",onClick:l,className:`
                w-full px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md
                hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500
              `,children:"Got it"})})]})]})})},Ei=({className:_=""})=>{const l=ie(Be),f=ie(Fr),[d,k]=ns.useState(!1),[S,E]=ns.useState(null),B=O.useCallback(async()=>{try{await ke.clearAllData()}catch(H){console.error("Failed to clear data:",H)}},[]);O.useEffect(()=>{ri().catch(console.error);const H=[Tt.register({key:"Escape",description:"Clear all data and filters",handler:Y=>{Y.preventDefault(),Fr.get()&&B()}}),Tt.register({key:"c",metaKey:!0,shiftKey:!0,description:"Copy filtered results to clipboard",handler:Y=>{Y.preventDefault();const M=document.querySelector("[data-copy-results]");M&&M.click()}}),Tt.register({key:"Enter",metaKey:!0,shiftKey:!0,description:"Apply all active filters",handler:Y=>{Y.preventDefault(),Fr.get()&&ke.applyAllActiveFilters().catch(console.error)}})];return()=>{H.forEach(Y=>Tt.unregister(Y))}},[]);const q=O.useCallback(H=>{E(H)},[]),V=O.useCallback(()=>{E(null)},[]);return a.jsx("div",{className:`${_}`,children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Line Filter Tool"}),a.jsx("button",{type:"button",onClick:()=>k(!0),className:`
                p-2 text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded
              `,title:"Help",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),a.jsx("p",{className:"text-gray-600",children:"Filter and search through large text files and CSV data efficiently"})]}),a.jsx("div",{className:"mb-6",children:a.jsx(fi,{})}),f?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Filters"}),a.jsx(ai,{})]}),a.jsx("button",{type:"button",onClick:B,className:"px-3 py-1.5 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 flex-shrink-0",children:"Clear Data"})]}),a.jsx("div",{className:"px-4 py-3 border-b border-gray-100",children:a.jsx("div",{className:"flex items-center space-x-4",children:a.jsx("div",{className:"flex-1 min-w-0",children:l==="csv"?a.jsx(li,{editingFilterId:S,onEditComplete:V}):a.jsx(oi,{editingFilterId:S,onEditComplete:V})})})}),a.jsx("div",{className:"px-4 py-2",children:a.jsx(ci,{onFilterEdit:q})})]}),a.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:a.jsx("div",{className:"p-6",children:l==="csv"?a.jsx(di,{}):a.jsx(ui,{})})})]}):a.jsx(ii,{}),a.jsx("div",{className:"mt-12 pt-6 border-t border-gray-200",children:a.jsx("div",{className:"text-center text-sm text-gray-500",children:a.jsxs("p",{children:["Part of"," ",a.jsx("a",{href:"/",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Devsgen"})," ","developer utilities"]})})}),a.jsx(hi,{isOpen:d,onClose:()=>k(!1)})]})})};export{Ei as default};
